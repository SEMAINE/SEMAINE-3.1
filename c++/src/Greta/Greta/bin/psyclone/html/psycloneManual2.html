<!DOCTYPE html PUBLIC "-//w3c//dtd html 4.0 transitional//en"><html><head>  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">  <link rel="stylesheet" href="style.css">  <title>Psyclone:Manual:Part2 of 4</title>  <script language="JavaScript">//if (self != top) {top.location=self.location;}//self.resizeTo(760,screen.availHeight)function stopErrors() {return true;}window.onerror = stopErrors;  </script>  <script language="JavaScript">function showAboutBox(thePage) {window.open(thePage, "About", 'width=190,height=100,toolbar=no,scrollbars=no,directories=no,menubar=no,status=no'); }function launchPostMessage(thePage) {window.open(thePage,'Post_Message','width=760,height=700,toolbar=yes,resize=yes,scrollbars=yes,directories=no,menubar=no,status=no'); }function openPage(thePage) {window.open(thePage,'','width=700,height=600,toolbar=yes,resize=yes,scrollbars=yes,directories=no,menubar=no,status=no'); }  </script><!--990000 //cccc99 -->  <link href="style.css" rel="stylesheet" type="text/css"></head><body leftmargin="20" topmargin="20" size="-2" face="Verdana, Arial, Helvetica, sans-serif" style="color: rgb(102, 0, 0);" link="#914e23" alink="#cc0000" vlink="#73643f"><div align="center">   <table bgcolor="#ffffff" border="0" cellpadding="0" cellspacing="0" height="36" width="688">    <tbody>      <tr align="right" valign="bottom">         <td class="navLink" align="left" height="18" width="129">&nbsp;</td>        <td class="navLink" align="left" height="18" width="130">&nbsp;</td>        <td class="navLink" align="left" height="30" width="217"> <div align="right"></div></td>        <td class="navLink" width="109">&nbsp;</td>        <td class="navLink" width="103"><a href="index.html">index_:</a>:</td>      </tr>      <tr align="right" valign="middle">         <td colspan="5" align="left" height="18"><br> <img src="images/simple-circle-line-1.gif"></td>      </tr>    </tbody>  </table>  <table border="0" cellpadding="0" cellspacing="0" height="82" width="688">    <tbody>      <tr>         <td align="left" background="" height="68" valign="middle" width="300"><img src="images/psycloneManualLogo.gif" width="300" height="44">         </td>        <td align="left" background="" valign="middle" width="388"><div align="center" class="boxTitle"><font size="3"><b><a href="psycloneTutorial.html">GETTING             STARTED / EXAMPLES</a></b><br>            <font size="2">PART 2 of 4</font></font></div></td>      </tr>      <tr>         <td height="14" colspan="2" align="left" valign="middle" background=""><img src="images/simple-circle-line-1.gif"></td>      </tr>    </tbody>  </table></div><table width="688" height="30" border="0" align="center" cellpadding="0" cellspacing="0">  <tbody>    <tr>      <td class="tutorialSectionHeading" align="left" height="30" valign="middle" width="147"><b><a href="index.html" class="tutorialSubsectionHeading">Back         to Index</a></b></td>      <td align="left" valign="CENTER" width="95"></td>      <td class="smallSizeNonConspicuous" align="right" valign="middle" width="446">An         index to the sections below is stored in index.html <br>        that should be part of the distribution that includes this file</td>    </tr>  </tbody></table><p align="center"><img src="images/simple-circle-line-1.gif"><a name="usingpsyclone" id="usingpsyclone"></a><a name="orderedlessons" id="orderedlessons"></a> <p align="center">&nbsp;  <table width="689" border="1" align="center" cellpadding="2" cellspacing="0" bordercolor="#999999" bgcolor="#cccccc">  <tbody>    <tr>      <td width="681" height="22026" valign="top" bordercolor="#999999" bgcolor="#cccccc">         <p>&nbsp;</p>        <table align="center" border="0" cellpadding="2" cellspacing="0" width="670">          <tbody>          <tr bordercolor="#B9B9B9" background="images/grey-bk.gif" bgcolor="#f7f7f7" valign="CENTER">            <td height="30" width="520"><b><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1"><a name="gettingstarted" id="gettingstarted"></a></font></font></font></b><span class="tutorialSubsectionHeading">Getting Started withPsyclone</span></td>            <td align="right" width="118"><b><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#b9b9b9"><a href="index.html" class="navLink"><b><font face="Verdana, Arial, Helvetica, sans-serif">Back to Index</font></b></a></font></font></b></td>            <td align="right" width="88">&nbsp;</td>          </tr>            <tr bgcolor="#f7f7f7">               <td colspan="3" height="947" valign="top"> <p>To learn the basic                   tenets of Psyclone jargon, go <a href="psycloneManual.html#psy:intro" class="navLink">here</a>.                 </p>                <p><font color="#333333" face="Verdana, Arial, Helvetica, sans-serif"><font size="-1">In                   the <span class="keyConcept">psyclone</span> directory you will                   find the Psyclone executable for your operating system ("psyclone"                   for OS X and Linux; "psyclone.exe" for Windows). </font></font>                 </p>                <p><font color="#333333"> <a name="commandlineip" id="commandlineip"></a>                   <font face="Verdana, Arial, Helvetica, sans-serif"><font size="-1">To                   run Psyclone, open a console window and cd into the psyclone                   directory.&nbsp;</font></font></font> </p>                <p><font color="#333333" face="Verdana, Arial, Helvetica, sans-serif"><font size="-1">The                   </font></font><span class="keyConcept">psyclone</span><font color="#333333" face="Verdana, Arial, Helvetica, sans-serif"><font size="-1">                   executable is run by the following command:</font></font> <span class="keyConcept"><font color="#333333"><font face="Verdana, Arial, Helvetica, sans-serif"><font size="-1"><strong>psyclone</strong></font></font></font>                   </span> </p>                <p><font color="#333333"><i><font face="Verdana, Arial, Helvetica, sans-serif"><font size="-1">&nbsp;Example:</font></font></i>                   <br>                  </font> <span class="commandlineText">&nbsp; &gt;./psyclone</span>                 </p> <p><font color="#333333" face="Verdana, Arial, Helvetica, sans-serif"><font size="-1">This                   should start Psyclone, giving some printout of its acitivities                   in the console.&nbsp;</font></font> </p>                <blockquote>                  <p><span class="smallSizeNonConspicuous"><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#666666"><font size="1">NOTE:                     If you get the following message:&nbsp;</font></font></font>                     <font size="1"><br>                    <font face="Verdana, Arial, Helvetica, sans-serif"><font color="#666666">&nbsp;&nbsp;                     ./psyclone: Permission denied.</font></font></font> <font size="1"><br>                    <font face="Verdana, Arial, Helvetica, sans-serif"><font color="#666666">you                     do not have execution permission in this directory. Execute                     the command:</font></font></font> <font size="1"><br>                    <font face="Verdana, Arial, Helvetica, sans-serif"><font color="#666666">&nbsp;                     &gt;chmod a+rwx *</font></font></font> <font size="1"><br>                    <font face="Verdana, Arial, Helvetica, sans-serif"><font color="#666666">at                     the command line, and then try running Psyclone again.</font></font></font>                     <font size="1"><br>                    </font></span><a name="usingpsyclone:psyspec" id="usingpsyclone:psyspec"></a>                   </p>                </blockquote>                <p> <font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333" size="-1">You                   can specify a setup file to use at the command line, called                   a <a href="psycloneManual.html#psy:psyspec">psySpec</a>, to                   initialize the system. The psySpec is read in by doing:</font></font>                 </p>                <p><font color="#333333"> <font face="Verdana, Arial, Helvetica, sans-serif"><font size="-1">&nbsp;&nbsp;                   <span class="keyConcept"><strong>psyclone spec="</strong>[<strong>psySpecName</strong>]"</span></font></font></font>                 </p>                <p><font face="Verdana, Arial, Helvetica, sans-serif"><font size="-1">&nbsp;Example:</font></font>                   <br>                  <span class="commandlineText">&nbsp; &gt;./psyclone spec="roundRobinPsySpec.xml"                   </span></p>                <p>The roundRobinPsySpec.xml is a simple example psySpec (should                   be included with your copy of Psyclone). To see what each of                   its parts mean, see the <a href="#roundrobintutorial" class="navLink">roundRobinPsySpec                   tutorial</a> below.</p>                <p><font color="#333333" face="Verdana, Arial, Helvetica, sans-serif"><font size="-1">Psyclone                   will print out an error if (a) it cannot find the specified                   psySpec. It will also print out errors if (b) the port specified                   is in use. <a href="psycloneManual4.html#troubleshooting" class="navLink">Troubleshooting</a>.</font></font>                 </p>                <p> <font color="#333333" face="Verdana, Arial, Helvetica, sans-serif" size="2">To                   quit Psyclone at the <a href="psycloneManual.html#psy:commandline" class="navLink">command                   line</a> press CTRL+C. <br>                  If CTRL+C at the command line doesn't work, pressing CTRL+C                   three times will perform a hard exit.</font> </p>                <p><span class="mediumSizeNonConspicuous">RELATED:</span><font face="Verdana, Arial, Helvetica, sans-serif"><font size="-1"><font color="#333333"><b><i>                   </i></b><span class="navLink"><a href="psycloneManual3.html#usingpsyspec">constructing                   a psySpec</a></span></font></font></font> </p>                <p><font color="#333333" face="Verdana, Arial, Helvetica, sans-serif"><font size="-1">There                   is a third parameter you can specify, which will help you understand                   what is going on at run-time with Psyclone. It is called verbose,                   and it is used in the following way:</font></font> <font color="#333333"><br>                  <br>                  <font face="Verdana, Arial, Helvetica, sans-serif"><font size="-1">&nbsp;                   </font></font></font><span class="keyConcept"><font face="Verdana, Arial, Helvetica, sans-serif"><strong>psyclone                   port=</strong>[<strong>port</strong>]<strong> spec="</strong>[<strong>psySpecName</strong><font face="Verdana, Arial, Helvetica, sans-serif"><font face="Verdana, Arial, Helvetica, sans-serif">]</font></font><strong>"                   verbose=</strong>[<strong>1,2,3,4</strong><font face="Verdana, Arial, Helvetica, sans-serif"><font face="Verdana, Arial, Helvetica, sans-serif">]</font></font></font>                   </span> </p>                <p><font color="#333333"><i><font face="Verdana, Arial, Helvetica, sans-serif"><font size="-1">&nbsp;Example:</font></font></i>                   <br>                  </font><span class="commandlineText">&nbsp; &gt;./psyclone port=20000                   spec="testPsySpec.xml" verbose=4 </span> </p>                <p><span class="mediumSizeNonConspicuous"><font color="#333333" face="Verdana, Arial, Helvetica, sans-serif"><font size="-1"><b><i>Related:</i></b></font></font></span><font color="#333333" face="Verdana, Arial, Helvetica, sans-serif"><font size="-1"><font color="#333333" face="Verdana, Arial, Helvetica, sans-serif">                   </font><span class="navLink"><a href="psycloneManual.html#console">command                   line parameters</a> <a href="psycloneManual.html#psy:verbose">verbose=</a><font color="#333333" face="Verdana, Arial, Helvetica, sans-serif">                   </font><a href="psycloneManual.html#psy:spec">spec=</a></span></font></font>                 </p>                <p><font color="#333333" face="Verdana, Arial, Helvetica, sans-serif"><font size="-1">If                   verbose is specified, Psyclone will print run-time messages                   to the console while running.&nbsp;</font></font> </p>                <p><font color="#333333" face="Verdana, Arial, Helvetica, sans-serif"><font size="-1">To                   see the status of Psyclone at run time, use </font></font><span class="conceptLink"><a href="psycloneManual2.html#usingpsyprobe" class="conceptLink">psyProbe</a></span><font color="#333333" face="Verdana, Arial, Helvetica, sans-serif"><font size="-1">,                   the Web-based monitoring tool.</font></font> </p>                <p><font color="#333333" face="Verdana, Arial, Helvetica, sans-serif"><font size="-1">Run                   <span class="navLink">the <a href="psycloneManual2.html#runningexternalmoduleexamples">example                   posting and receiving modules</a></span> to see a demonstration                   of how the posting and registration works in Psyclone.</font></font>                 </p>                <p><font color="#333333" face="Verdana, Arial, Helvetica, sans-serif" size="2"><a name="quitpsyclonefrompsyprobe" id="quitpsyclonefrompsyprobe"></a>To                   quit Psyclone from <a href="psycloneManual.html#psyprobe" class="navLink">psyProbe</a>                   you can use the link the bottom of the main psyProbe page. <br>                  <br>                  To quit Psyclone at the <a href="psycloneManual.html#commandline" class="navLink">command                   line</a> press CTRL-C. </font> </p>                <p><font color="#333333" face="Verdana, Arial, Helvetica, sans-serif" size="2">                   If CTRL-C at the command line doesn't make Psyclone shut down                   nicely, pressing CTRL-C three times will perform a hard exit.</font>                 </p></td>          </tr>        </tbody>      </table>      <p>&nbsp;</p>      <table align="center" border="0" cellpadding="2" cellspacing="0" width="670">        <tbody>          <tr>            <td background="images/grey-bk.gif" bgcolor="#f7f7f7" height="20" valign="middle" width="193">            <p><span class="tutorialSubsectionHeading"><a name="usingpsyprobe" id="usingpsyprobe"></a>UsingpsyProbe</span> </p>            </td>            <td align="right" background="images/grey-bk.gif" bgcolor="#f7f7f7" height="30" valign="CENTER" width="390"><b><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#b9b9b9"><a href="index.html" class="navLink"><b><font face="Verdana, Arial, Helvetica, sans-serif">Back to Index</font></b></a></font></font></b></td>            <td background="images/grey-bk.gif" bgcolor="#f7f7f7" valign="top" width="75">&nbsp;</td>          </tr>          <tr bgcolor="#f7f7f7">            <td colspan="3" height="157" valign="top"><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1"><b><a href="psycloneManual.html#psyprobe">psyProbe</a></b>is the web-based monitoring interface for <a href="#psyclone" class="navLink">Psyclone</a>. With it you can view theinternals of Psyclone at run-time. Before you can use psyProbe you haveto <a href="#usingpsyclone" class="navLink">runPsyclone</a>. </font></font></font>            <p><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">Use                   psyProbe by typing the following into the URL box on your browser:                   <br>                  <br>                  &nbsp;&nbsp;<strong>http://</strong></font><font color="#333333" face="Verdana, Arial, Helvetica, sans-serif" size="-1">[</font><font size="-1"><strong>machine</strong>]<strong>:</strong></font><font color="#333333" face="Verdana, Arial, Helvetica, sans-serif" size="-1">[</font><font size="-1"><strong>psyclonePort</strong>]</font></font></font></p>                <p>&nbsp;</p>                <p><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">                   <br>                  where <span class="keyConcept">[psyclonePort]</span> is the                   <a href="psycloneManual.html#commandlineip" class="navLink">port</a>                   that Psyclone was started up with, or assigned to psyProbe in                   the psySpec (the default is <strong>10000</strong> if nothing                   is specified), and <span class="keyConcept">[machine]</span>                   is either the IP address for the machine that Psyclone is running                   on, or its name, or the word "localhost". </font></font></font>                 </p>            <p><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">For example, ifyour machine's name is "matrix", and Psyclone is running on port 10000,you would type <em>http://matrix:10000 into your browser. Youcan also type http://localhost:10000</em></font></font></font></p>            <blockquote>              <p><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#666666" size="-2">Notice: You may have to use              <strong>http://</strong> in the path sincemost browsers do not default to this protocol by themselves. Morespecifically, </font><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1"><font color="#666666" size="1"> when you use psyProbe youare not using port 80 on the computer (the default port for httptransfer); the browser may not know to default to the http:// protocolfor any other port than port 80.</font></font></font></font></font></p>            </blockquote>            <p><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1"><a name="postmessage" id="postmessage"></a><span class="tutorialSubsectionHeading"><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">Posting Messages<br>            </font></font></font></span>Go tothe Post Message page by clicking on the <span class="navLink"><b>post_message_page_::</b></span>link on the main psyProbe page (if you have Psyclone currently runningyou can go there now by clicking <a href="JavaScript:launchPostMessage('postmessage');">here</a>).&nbsp;</font></font></font>            </p>                <p><span class="tutorialSubsectionHeading"><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">                   </font></font></font></span><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">                   To post a message to a Psyclone Whiteboard you need to specify                   three things, at a minimum: Who the message is from, which Whiteboard(s)                   will receive the message, and what type the message is. You                   specify the sender in the first panel (the one called <b>from</b>).                   The <b>to</b> on the page contains a list of the Whiteboards                   &#8212; check off one or more Whiteboards. The third                   panel on the page, <span class="navLink"><b>post_message_::</b></span>,                   allows you to manually key in the message type, and the message                   content, if you have any. When this is done, you can post your                   message by pressing the 'post' button at the bottom.</font></font></font>                 </p>                <p><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">In                   addition to this, you can make any module receive a '<b>cc</b>'                   on your message. This is done in the <b>from</b> panel. A 'cc'd                   module will receive (i.e. it will be woken up by) the message                   no matter whether it registered for its type or not.</font></font></font>                 </p>                <p><span class="tutorialSubsectionHeading"><a name="whiteboards:messageandstreamdifferences" id="whiteboards:messageandstreamdifferences"></a>Whiteboards<br>                  </span>Whiteboards can carry discrete messages and continuous                   streams. The two differ in that messages are like email: You                   receive a message and that it is that, unless you write back                   that is. Streams are like a phone call: You get a ring and you                   pick up, and there is something more coming. The whole thing                   continues until you hang up. During the phone call you know                   that what comes through is audio (as opposed to video or a fax).                 </p>                <p>Therefore, when you use psyProbe to view the content of the                   whiteboards, the stream samples do not show up in the same way                   as messages do, as they reside inside whichever streams they                   belong to Whiteboard. PsyProbe lists messages and streams separately,                   and you need to look at the streams to see your samples, whether                   they are video, audio, or something else. </p>                <p> Samples in streams normally come in rapid succession (10s                   or 100s each second). Usually one module post to a stream and                   one or more will be subscribers. As a result, each datasample                   doesn't have a named type, they all automatically live inside                   a stream, which lives in a whiteboard. Receivers of the streams                   can perform time-based searches inside the stream and don't                   only have to receive all the samples in turn. </p>            <p><span class="tutorialSubsectionHeading"><a name="usingwbfilters" id="usingwbfilters"></a><a name="usingbbfilters" id="usingbbfilters"></a>UsingWhiteboard Filters<br>            </span> <font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">The Whiteboardpage allows you to filter the messages shown on the messages page. Ifyou are using the <a href="psycloneManual.html#psy:messagetypeontology">recommended</a>dot-delimited message name format (e.g. My.Example.Message.Type,Input.hearing.voice), you can construct filters using a star (*) as awildcard. </font></font></font></p>            <p><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">For example,let's say that the Whiteboard contains the following 5 message types:</font></font></font>            </p>            <p><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1"><em>&nbsp;Namespace.Input.Message.One</em></font></font></font>            <em><br>            <font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">&nbsp; <font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><em>Namespace.</em></font></font>Output.Message.Alpha</font></font></font>            <br>            <font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">&nbsp; <font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><em>Namespace2.</em></font></font>Output.Message.Omega</font></font></font>            <br>            <font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">&nbsp; <font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><em>Namespace3.</em></font></font>My.Input.Message.One</font></font></font>            <br>            <font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">&nbsp; <font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><em>Namespace3.</em></font></font>My.Output.Info.Two</font></font></font>            </em> </p>            <p><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">The filterpattern <b>*Namespace.*</b> will result in only the firstand second messages types showing on the page. The pattern <b>Namespace3.My.Input.*</b>will block all messages except the fourth in the list. The pattern <b>*.Message.*</b>will, in this example, show all messages except the last one. </font></font></font>            </p>            <p><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">This mechanismis very useful for making sure that messages that should be posted havebeen posted. The filtering is not limited to dot-delimitation; you canspecify for example <strong>*M*</strong> and allmessagetypes above above will be allowed; <strong>*essag*</strong>to exclude the last one.</font></font></font> </p>            <p><font color="#333333" face="Verdana, Arial, Helvetica, sans-serif" size="-1">Thecontent filter allows you to filter on any content of the messages. Ifyou use this feature only messages which contain a particular string intheir content will be listed in the list. </font><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">(Content refersto the <strong>payload</strong> of messages.) The inputfield in the <strong>content</strong> filter allows you toinput any ASCII string for this purpose. For example, <span class="keyConcept">*clone*</span> will filter out allmessages except those which contain the string "clone" somewhere in thecontent.</font></font></font> </p>                <p><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">The                   amount of content shown in the table can also be set with the                   radio buttons <strong>none</strong>, <strong>tiny</strong>,                   <strong>full</strong>. Selecting "none" will hide the content                   of the messages; selecting tiny will show the first line of                   the content (or a summary of the content, if Psyclone knows                   how to parse it); "full" will show the full content of all messages                   below each message in the table.</font></font></font> </p>                <p class="tutorialSubsectionHeading">Using psyProbe With Satellites</p>                <p>If you want to use <a href="#psyprobe" class="navLink">PsyProbe</a>                   to see WBs running in the <a href="psycloneManual3.html#usingsatellites"><span class="navLink">Satellite</span></a>,                   you must put a copy of the full HTML tree (from the Psyclone                   distribution) next to the Psyclone Satellite Server in the directory                   where you run the Psyclone -satelliteserver command.                 </p>            </td>          </tr>        </tbody>      </table>      <p>&nbsp;</p>        <table align="center" border="0" cellpadding="2" cellspacing="0" width="670">          <tbody>          <tr background="images/grey-bk.gif" bgcolor="#f7f7f7" valign="CENTER">            <td class="tutorialSubsectionHeading" height="30" width="455"><a name="creatingyourfirstpsyclone" id="creatingyourfirstpsyclone"></a>Creating andrunning your first Psyclone system</td>            <td align="right" width="49">&nbsp;</td>            <td align="right" width="118"><b><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#b9b9b9"><a href="index.html" class="navLink"><b><font face="Verdana, Arial, Helvetica, sans-serif">Back to Index</font></b></a></font></font></b></td>            <td align="right" width="83">&nbsp;</td>          </tr>          <tr bgcolor="#f7f7f7">            <td colspan="4" height="509" valign="top">            <p>Whether you are a novice or expert in modelingcomplex systems the best place to start will probably be the examplesprovided with the Psyclone distribution (see the <a href="index.html" class="navLink">index</a>). </p>            <p>The path of least resistance (can be taken in anyorder, except the first two):</p>                <blockquote>                   <p><span class="navLink"><a href="#gettingstarted">Getting started                     with Psyclone</a> <br>                    <a href="psycloneManual.html#concepts">Concepts: Whiteboards,                     Modules, Messages, Streams</a><br>                    <a href="#runningjavaexamples">Running the provided external                     Java examples</a><br>                    <a href="#runningcppexamples">Running the provided external                     C++ examples</a><br>                    <a href="#runninginternalcppexamples">Running the provided                     internal C++ examples</a><br>                    <a href="#dominosexample">Running the provided roundRobinPsySpec                     example</a> <br>                    <a href="#dominosexample">Running the provided dominoPsySpec                     example</a> </span></p>            </blockquote>            <p>There are several things that need to beconsidered when creating the first system using Psyclone. Firstly,Psyclone uses a few <a href="psycloneManual.html#concepts">newconcepts</a> that you may want to familiarize yourself with.Secondly, you will want to look at the message and routing protocolthat Psyclone uses, called <a href="http://www.mindmakers.org/openair/">OpenAIR</a>.Thirdly you probably should look at the examples provided with thedistribution. </p>                <p>One of the complicating things about real-time systems with independent                   elements is the way that causality works in them &#8212;                   when each element can operate independent of the others some                   causal chain of events that the designer wanted to happen may                   not happen because one or more events in the system don't always                   happen at the right time. Systems which are highly time-dependent,                   and especially systems which are intended to interact with the                   real world, will most likely need to be tuned and tested before                   they operate as intended. Yet there is no other way to model                   many of the highly complex systems we see in the world. Here                   is what you can do: </p>                <ul>                  <li> <span class="basicBullets">The Constructionist Design Methodology                     provides some principles to help with this and related problems.                     Mindmakers.org has <a href="http://www.mindmakers.org/courseMaterialsPage.jsp">a                     </a></span><span class="navLink"><a href="http://www.mindmakers.org/courseMaterialsPage.jsp">section                     on this methodology</a></span><span class="basicBullets">.                     </span></li>                  <li> <span class="basicBullets">Go through as many tutorials                     on Psyclone as you can before starting to design your own                     system &#8212; be prepared to have to redo some of                     your design.</span></li>                  <li class="basicBullets">Use your own carefully designed <a href="psycloneManual.html#psy:messagetypeontology" class="navLink">message/stream                     type ontology</a> or a third-party ontology.</li>                  <li class="basicBullets">Desing your system to be resilient                     to temporal variation is events. <span class="navLink"> </span>                   </li>                </ul>            </td>          </tr>        </tbody>      </table>      <p>&nbsp;</p>        <table align="center" border="0" cellpadding="2" cellspacing="0" height="879" width="670">          <tbody>          <tr background="images/grey-bk.gif" bgcolor="#f7f7f7" valign="CENTER">            <td class="tutorialSectionHeading" height="30" width="407"><a name="runningjavaexamples" id="runningjavaexamples"></a> <a name="runningexternalmoduleexamples"></a>Running theprovided external Java examples</td>            <td align="right" width="34">&nbsp;</td>            <td align="right" width="118"><b><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#b9b9b9"><a href="index.html" class="navLink"><b><font face="Verdana, Arial, Helvetica, sans-serif">Back to Index</font></b></a></font></font></b></td>            <td align="right" width="100">&nbsp;</td>          </tr>            <tr bgcolor="#f7f7f7">               <td height="860" colspan="4" valign="top">                 <p>Java examples are                   included in the JavaAIRPlug download. <font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">The                   examples included are <span class="keyConcept"><strong>JavaPoster.java</strong></span>                   and <strong> <span class="keyConcept">JavaReader.java</span></strong>.                   The JavaPoster simply posts a message <font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333">of                   type <span class="keyConcept"><b>My.Test.Message.Type</b></span></font></font></font>                   <font size="-1">to whiteboard <span class="keyConcept"><strong>WB1</strong></span>                   when you press the return key. The JavaReader is an example                   of a module that registers with whiteboard <strong> <span class="keyConcept">WB1</span></strong>                   for that same message type, and simply prints it to the console.</font></font></font></p>                <p><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">To                   run (on Linux and Mac OS X), do:</font></font></font> <br>                  <font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">&nbsp;                   java -classpath ./:JavaOpenAIR.jar JavaReader psyclone=[psyclone                   host</font><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333" size="-1">]:</font></font></font></font><font size="-1">[psyclone                   port]</font></font></font> </p>                <p><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">where                   [psyclone host] is either the <a href="psycloneManual.html#computeripaddress" class="navLink">IP                   address</a> of your machine or the word <i>localhost</i>, and                   [psyclone port] is the port that you <a href="#gettingstarted" class="navLink">started                   Psyclone up with</a>.</font></font></font> </p>                <p class="example"><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">&nbsp;                   Example command (on Linux, with Psyclone running on port 10000):&nbsp;</font></font></font>                 </p>                <p class="example"> <font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">&nbsp;                   <i>&gt;java -classpath ./:</i><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><em>JavaOpenAIR</em></font></font><i>.jar                   JavaReader psyclone=localhost:10000</i></font></font></font>                 </p>                <p>If you have problems with Java you may want to recompile the                   files (see below).</p>                <p><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">Notice                   that on <span class="keyConcept"><b>Windows</b></span> you will                   be using a slightly different syntax for paths:&nbsp;</font></font></font>                   <br>                  <font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">&nbsp;                   java -classpath .;<font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333">JavaOpenAIR</font></font>.jar                   JavaReader psyclone=[psyclone host]:[psyclone port] </font></font></font></p>                <p><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">                   i.e. use semicolon instead of colon.</font></font></font> </p>                <p><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">I</font><font size="-1">f                   you are using <span class="keyConcept"><b>Cygwin</b></span>                   on <span class="keyConcept"><b>Windows</b></span> you will be                   using yet another syntax for paths:</font></font></font><br>                  <font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">&nbsp;                   java -classpath .;<font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333">JavaOpenAIR</font></font>.jar                   JavaReader [psyclone host] [psyclone port] </font></font></font></p>                <p><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">                   i.e. use semicolon instead of colon, and for paths, use backslash                   "\" instead of forward slash "/".</font></font></font></p>                <p><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">Now                   you need to go to another console window, and in the same JavaExamples                   directory, do:</font></font></font> </p>                <p> <span class="example"><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">&nbsp;                   Example (Linux):&nbsp;</font></font></font> <br>                  <font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">&nbsp;                   <i>&gt;java -classpath ./:</i><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><em>JavaOpenAIR</em></font></font><i>.jar                   JavaPoster psyclone=localhost:10000</i></font></font></font>                   </span></p>                <p> <font color="#333333" face="Verdana, Arial, Helvetica, sans-serif" size="-1">                   </font> <font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">Pressing                   Enter on the <span class="keyConcept"><b>JavaPoster</b></span>                   you should see the <span class="keyConcept"><b>JavaReader</b></span>                   print out that it received it, on the command line.</font></font></font>                 </p>                <blockquote>                  <p><font face="Verdana, Arial, Helvetica, sans-serif"><span class="smallSizeNonConspicuous"><font color="#666666"><font size="1">If                     you get a message of the effect 'java.lang.OutOfMemoryError',                     you may need to provide a command-line parameter to ensure                     sufficient memory allocation for Java.&nbsp;</font></font></span></font>                     <span class="smallSizeNonConspicuous"><font size="1"><br>                    <font face="Verdana, Arial, Helvetica, sans-serif"><font color="#666666">Use                     the following command to run Java:</font></font></font> </span></p>                  <p><font size="1"> <span class="example"><i><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#666666">&nbsp;                     &gt;java -Xincgc -Xms50M -Xmx200M -classpath ./:JavaOpenAIR.jar                     JavaReader psyclone=localhost:10000&nbsp;</font></font></i></span></font></p>                  <p><font size="1"><span class="smallSizeNonConspicuous"><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#666666">The                     first parameter is incremental garbage collection, the second                     is the startup memory size and the third is the maximum. In                     this example, an out of memory error would not occur until                     Java has used up 200MB of memory.&nbsp;</font></font></span></font>                   </p>                </blockquote>                <p><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">To                   <span class="keyConcept"><b>compile the Java examples</b></span>                   you need to include the <span class="keyConcept"><strong>JavaOpenAIR</strong></span>                   libraries.</font></font></font> <font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">To                   compile the Java examples you will need the need to download                   and use the <a href="http://java.sun.com/j2se/1.4.2/download.html" class="navLink">Sun                   Java SDK</a> (c</font></font></font></font></font><font size="-1">hoose                   the one that is appropriate to your platform). </font></font></font></p>                <p> <font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">&nbsp;                   javac -classpath <font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333">JavaOpenAIR</font></font>.jar                   JavaReader.java</font></font></font> <br>                  <font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">&nbsp;                   javac -classpath <font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333">JavaOpenAIR</font></font>.jar                   JavaPoster.java&nbsp;</font></font></font> </p>                <p><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">To                   compile on <span class="keyConcept"><b>Linux</b></span><b> </b>and<b>                   <span class="keyConcept">Mac OS X</span></b>, do:</font></font></font>                 </p>                <p><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">&nbsp;Example:&nbsp;</font></font></font>                   <br>                  <span class="commandlineText">&nbsp; &gt;javac -classpath ./:JavaOpenAIR.jar                   JavaPoster.java </span></p>                <p><span class="example"> <i><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">&nbsp;and:</font></font></font></i>                   <br>                  </span><span class="commandlineText">&nbsp; &gt;javac -classpath                   ./:JavaOpenAIR.jar JavaReader.java </span> </p>                <p><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1">Both                   should return <font color="#661e20">without</font> error (<a href="mailto:support@cmlabs.com" class="navLink">let                   us know</a> if you have problems). Use the above commands to                   run them.</font></font></font></p></td>          </tr>        </tbody>      </table>      <p>&nbsp;</p>        <table align="center" border="0" cellpadding="2" cellspacing="0" width="670">          <tbody>          <tr background="images/grey-bk.gif" bgcolor="#f7f7f7" valign="CENTER">            <td class="tutorialSubsectionHeading" height="30" width="460"><a name="externaljavaexampleindetail" id="externaljavaexampleindetail"></a>External Javamodule example in detail</td>            <td align="right" width="18">&nbsp;</td>            <td align="right" width="112"><b><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#b9b9b9"><a href="index.html" class="navLink"><b><font face="Verdana, Arial, Helvetica, sans-serif">Back to Index</font></b></a></font></font></b></td>            <td align="right" width="80">&nbsp;</td>          </tr>          <tr bgcolor="#f7f7f7">            <td colspan="4" height="70" valign="top">            <p>To read about external modules in general, go <a href="psycloneManual.html#psy:externalmodules" class="navLink">here</a>.            </p>            <p>To write an external module in Java, you will needthe Java AIR Plug. (If JavaAIRPlug was not included with thisdistribution you can download the plug by going to <a href="http://www.cmlabs.com/psyclone/download/" class="navLink">http://www.cmlabs.com/psyclone/download/</a>,and selecting the platform that you are developing your external moduleon). </p>            <p> We will assume that you start your external Javamodule manually. To start modules automatically, see the tutorial on <a href="psycloneManual3.html#automaticmodulestartup"><span class="navLink">Automaticallystarting modules</span></a>. </p>            <p> To write an external Java module, you will needto create a source file bearing the name of your module. We will createa module call Reader, with source Reader.java. </p>            <p> Initially in your source file you will alwaysneed to import the AIR package that come with the plug:<br>package com.cmlabs.air; After creating a class definition and creatinga few instance variable: </p>            <blockquote>              <p class="codeJava"> public class Reader {<br>private JavaAIRPlug plug; // the connection to Psyclone<br>private Message triggerMessage; // reusable incoming message<br>private Message msg; // reusable ougoing message</p>            </blockquote>            <p> you will create a 3-arg constructor:</p>            <blockquote>              <p class="codeJava"> public Reader(StringplugName, String host, int port) {</p>            </blockquote>            <p> In the constructor, instantiate the module</p>            <blockquote>              <p class="codeJava"> plug = newJavaAIRPlug(plugName, host, port);</p>            </blockquote>            <p> and use the plug call init() to connect toPsyclone:</p>            <blockquote>              <p class="codeJava"> if (!plug.init()) {<br>                    &nbsp;&nbsp;&nbsp;System.out.println("Could not connect to                     the Server on " + host +  on port " + port + "...");<br>&nbsp;&nbsp;&nbsp;System.exit(0);<br>} </p>            </blockquote>            <p> Next, the important work that the module needs todo can now be written. This sample code simply waits for a triggermessage (of message type that is specified in the psySpec for thismodule) by using the plug call <span class="codeJava">waitForNewMessage(longms)</span>, and prints information about the trigger message whenthe module is woken up. Additionally, a new basic message is create,given to the plug as a message to post using the plug call <span class="codeJava">addOutputMessage()</span>, and thenpost a message (of message type that is specified in the psySpec forthis module) using the call <span class="codeJava">sendOutputMessages()</span>:            </p>            <blockquote>              <p class="codeJava"> while (true) {<br>&nbsp;&nbsp;&nbsp;if ((triggerMessage =plug.waitForNewMessage(50)) != null) {<br>&nbsp;&nbsp;&nbsp;System.out.println(triggerMessage.postedTime.printTime()+ ": Reader&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;receivedmessage " + triggerMessage.type + " from " +&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;triggerMessage.from);              <br>&nbsp;&nbsp;&nbsp;msg = new Message("", "", "");<br>&nbsp;&nbsp;&nbsp;plug.addOutputMessage(msg);<br>&nbsp;&nbsp;&nbsp;plug.sendOutputMessages();<br>} else {<br>if (!tv.isServerAvailable())<br>&nbsp;&nbsp;&nbsp;System.out.printf("Psyclone is availablebut the module <br>&nbsp;&nbsp; has not been awoken ");<br>else<br>&nbsp;&nbsp;&nbsp;System.out.printf ("Psyclone is notavailable");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;}<br>} </p>            </blockquote>            <p> Finally, you will need a <span class="codeJava">main()</span> method in the class inorder to startup the module. The main() method will generally compriseof code that interprets some of the command-line parameters that wouldbe important, such as the host and port that Psyclone is running on.Some sample code that can be used in the external module to do thiswould be: </p>            <blockquote>              <p class="codeJava"> public static voidmain(String[] args) {<br>String usage = "Reader usage: Reader&nbsp;&nbsp;[psyclone=[psycloneHost][:psyclonePort]][name=Reader] (eg \"Reader &nbsp;&nbsp;psyclone=:27000\")";<br>// default host and port<br>String host = "localhost";<br>int port = 10000;<br>String name = "Reader";<br>String arg;<br>for (int n = 0; n &lt; args.length; n++) {<br>&nbsp;&nbsp;&nbsp;arg = args[n];<br>&nbsp;&nbsp;&nbsp;if (arg.startsWith("psyclone=")) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String str= arg.substring(9);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(str.length() &gt; 0) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;intpos = str.indexOf(":");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(pos &lt; 0)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;host= str;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elseif (pos &gt; 0)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;host= str.substring(0, pos);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;port= Utils.str2int(str.substring(pos + 1));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;} else if (arg.startsWith("name=")) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name =arg.substring(5);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;Reader reader = new Reader(name, host,port);<br>} </p>            </blockquote>            </td>          </tr>        </tbody>      </table>      <p>&nbsp;</p>        <table align="center" border="0" cellpadding="2" cellspacing="0" width="670">          <tbody>          <tr background="images/grey-bk.gif" bgcolor="#f7f7f7" valign="CENTER">              <td height="30" width="413"><b><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1"><a name="runningcppexamples" id="runningcppexamples"></a><a name="runningexternalcppexamples" id="runningexternalcppexamples"></a>Running                 the provided external c++ example</font></font></font></b></td>            <td align="right" width="61">&nbsp;</td>            <td align="right" width="116"><b><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#b9b9b9"><a href="index.html" class="navLink"><b><font face="Verdana, Arial, Helvetica, sans-serif">Back to Index</font></b></a></font></font></b></td>            <td align="right" width="80">&nbsp;</td>          </tr>            <tr bgcolor="#f7f7f7">               <td colspan="4" height="752" valign="top">                 <p>This external C++                   example is included in the CppAIRPlug download. <font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333" size="-1">The                   example inlcudes two programs called <strong>CppPoster</strong>                   and <strong>CppReader</strong>. The </font><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333" size="-1">CppPoster</font></font><font size="-1">                   simply posts a message <font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333">of                   type <b>My.Test.Message.Type</b></font></font></font> <font size="-1">to                   whiteboard <strong>WB1</strong> when you press the return key.                   The </font><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333" size="-1">CppReader</font></font><font size="-1">                   is an example of a module that registers with whiteboard<strong>                   WB1</strong> for that same message type, and simply prints it                   to the console.</font></font> This examples parallels the example                   of external modules written in Java.</p>                <p class="mediumSizeNonConspicuous">Before you run the code you                   will need to compile it. Refer to the QUICKSTART file for the                   external C++ example that is provided with the Psyclone distribution.</p>                <p><font color="#333333" face="Verdana, Arial, Helvetica, sans-serif"><font size="-1">To                   run the <b>C++ examples</b> you will have to have a Whiteboard                   called WB1 already running in Psyclone. The simplest way to                   do this is to just start up Psyclone:</font></font></p>                <blockquote>                   <p class="commandlineText">./psyclone</p>                </blockquote>                <p><font color="#333333" face="Verdana, Arial, Helvetica, sans-serif"><font size="-1">and                   then, in the directory where the C++ examples are, give the                   command:</font></font> </p>                <blockquote>                   <p><span class="commandlineText">&gt; CppReader psyclone=[psyclone                     host]:[any port number] </span> </p>                </blockquote>                <p class="smallSizeNonConspicuous"><font face="Verdana, Arial, Helvetica, sans-serif">The                   colon : has to be there if you give a port number; you don't                   need to specify psyclone=localhost:10000 at all if you want                   to use the default of localhost:10000. </font> </p>                <p><font face="Verdana, Arial, Helvetica, sans-serif">and in another                   console window, do: </font> </p>                <blockquote>                   <p class="commandlineText">&gt; CppPoster psyclone=[psyclone                     host]:[any port number] </p>                </blockquote>                <p><font face="Verdana, Arial, Helvetica, sans-serif"><font face="Verdana, Arial, Helvetica, sans-serif">in                   this order, each in its own console window, where <span class="commandlineText">[psyclone                   host] </span>is the IP address of the computer running Psyclone,                   the name of the computer running Psyclone (or the word "localhost",                   if you're running the example on the same machine as Psyclone).                   The Reader will register with whiteboard WB1 for a message of                   type Test.Message.Type. CppPoster will post a message of type                   Test.Message.Type once every second. </font></font></p>                <p><font face="Verdana, Arial, Helvetica, sans-serif"><font face="Verdana, Arial, Helvetica, sans-serif">When                   CppPoster posts a message it goes to WB1, which then sends it                   to the registered CppReader module. If you look at WB1 in <a href="psycloneManual.html#psyprobe"><span class="navLink">psyProbe</span></a>                   you can see the message entered every time foor both events.                   To run psyProbe, start a Web browser and type into it:</font></font></p>                <blockquote>                  <p><font face="Verdana, Arial, Helvetica, sans-serif"><font face="Verdana, Arial, Helvetica, sans-serif">                     http://localhost:10000</font></font></p>                </blockquote>                <p><font face="Verdana, Arial, Helvetica, sans-serif"><font face="Verdana, Arial, Helvetica, sans-serif">                   This should give you the front page of psyProbe. (If you get                   something else, make sure you have included the html directory                   in the same directory as Psyclone.) Here you can probe around                   to see what is happening to your messages and your modules.</font></font></p>                <p>&nbsp;</p>                <p class="tutorialSectionHeading"><font face="Verdana, Arial, Helvetica, sans-serif">Compiling                   the C++ Examples</font></p>                <p><font size="2">To compile the C++ examples for Linux or Mac                   OS X, use the </font><span class="keyConcept">Make file</span><font size="2">                   included with the examples. For Windows you need the Visual                   Studio 6 (.NET project files can be made available). </font></p>                <p><span class="mediumSizeNonConspicuous">Related:</span>&nbsp;<span class="navLink"><a href="http://www.mindmakers.org/projects/Psyclone/pages/info/Windows_PsycloneSDK_info.html#howtorun">How                   to run the SDK</a></span></p></td>          </tr>        </tbody>      </table>      <p>&nbsp;</p>        <table align="center" border="0" cellpadding="2" cellspacing="0" width="670">          <tbody>          <tr background="images/grey-bk.gif" bgcolor="#f7f7f7" valign="CENTER">            <td class="tutorialSubsectionHeading" height="30" width="387"><a name="externalcppexampleindetail" id="externalcppexampleindetail"></a>External C++module example in detail</td>            <td align="right" width="91">&nbsp;</td>            <td align="right" width="112"><b><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#b9b9b9"><a href="index.html" class="navLink"><b><font face="Verdana, Arial, Helvetica, sans-serif">Back to Index</font></b></a></font></font></b></td>            <td align="right" width="80">&nbsp;</td>          </tr>          <tr bgcolor="#f7f7f7">            <td colspan="4" height="78" valign="top">            <p>To read about external modules in general, go <a href="psycloneManual.html#psy:externalmodules" class="navLink">here</a>.            </p>            <p>To write an external module in C++, you will needthe CppAIRPlug. (If CppAIRPlug was not included with this distributionyou can download the plug by going to <a href="http://www.cmlabs.com/psyclone/download/" class="navLink">http://www.cmlabs.com/psyclone/download/</a>,and selecting the platform that you are developing your external moduleon). </p>            <p> We will run this external module manually. (Thetutorial on <a href="psycloneManual3.html#automaticmodulestartup"><span class="navLink">Automatically starting modules</span></a>explains how to do this automatically.) </p>            <p> To write an external C++ module, you will need asource and header file bearing the name of your module. The Readerexample with the Psyclone distribution is <span class="keyConcept">Reader.cpp</span>and <span class="keyConcept">Reader.h</span>. </p>            <p> The header file must contain at least thefollowing, using Reader as the example: </p>            <blockquote>              <p class="codeCPP"> #include "Communicator.h"<br>#include "Component.h"<br>#include "CppAIRPlug.h"<br>class Reader : public CppAIRPlug<br>{<br>&nbsp;&nbsp;&nbsp;public:<br>&nbsp;&nbsp;&nbsp;Reader(JString name, JString host, intport);<br>&nbsp;&nbsp;&nbsp;virtual ~Reader();<br>};</p>            </blockquote>            <p> The source files must first and foremost includethe header:</p>            <blockquote>              <p class="codeCPP"> #include "Reader.h"</p>            </blockquote>            <p> The source file must also have a constructor anddestructor:</p>            <blockquote>              <p class="codeCPP">CppReader::CppReader(JStringname, JString host, int port) :CppAIRPlug(name, host, port) {}<br>CppReader::~CppReader() {}</p>            </blockquote>            <p> The source file must have a <span class="codeCPP">main()</span> function in order tostartup the module:</p>            <blockquote>              <p class="codeCPP"> int main(int argc, char*argv[]) </p>            </blockquote>            <p> The <span class="codeCPP">main()</span>function will generally first contain some code that interprets some ofthe command-line parameters that would be important, such as the hostand port that Psyclone is running on. Some sample code that can be usedin the external module to do this would be: </p>            <blockquote>              <p class="codeCPP"> JString host ="localhost";<br>int port = 10000;<br>JString allArgs;<br>for (int ii=0; ii&lt;argc; ii++) {<br>&nbsp;&nbsp;&nbsp;allArgs += JString(argv[ii]) + " ";<br>}<br>allArgs.trim();<br>Dictionary argDict = allArgs.splitCommandLine();<br>JString arg;<br>JString val;<br>for (int n=1; n&lt;argDict.getCount(); n++) {<br>&nbsp;&nbsp;&nbsp;arg = argDict.getKey(n);<br>&nbsp;&nbsp;&nbsp;val = argDict.get(n);<br>&nbsp;&nbsp;&nbsp;if (arg.equalsIgnoreCase("psyclone")) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Collectioncol = val.trim().split(":");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(col.get(0).length() &gt; 0)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;host =col.get(0);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(col.get(1).length() &gt; 0)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;port =col.get(1).toInt();<br>&nbsp;&nbsp;&nbsp;}<br>} </p>            </blockquote>            <p> The module should then be instantiated: </p>            <blockquote>              <p class="codeCPP"> CppReader* tv = newCppReader("CppReader", host, port); </p>            </blockquote>            <p> and use the plug call <span class="codeCPP">init()</span>to connect to Psyclone: </p>            <blockquote>              <p class="codeCPP"> if (!tv-&gt;init()) {<br>&nbsp;&nbsp;&nbsp;printf("Could not connect to Psyclone on'%s' port %d, exiting...\n\n", (char*) host, port);<br>return 0;<br>} </p>            </blockquote>            <p> Since you are running the module manually, youmay now test for the availability of Psyclone and, if available, startthe module, otherwise, delete the module and exit from the program: </p>            <blockquote>              <p class="codeCPP"> if(tv-&gt;isServerAvailable()) {<br>&nbsp;&nbsp;&nbsp;tv-&gt;start();<br>} else {<br>&nbsp;&nbsp;&nbsp;printf("Could not connect to Psyclone on'%s' port %d, <br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;exiting...\n\n",(char*) host, port);<br>&nbsp;&nbsp;&nbsp;delete(tv);<br>&nbsp;&nbsp;&nbsp;exit(0);<br>} </p>            </blockquote>            <p> Finally, the important work that the module needsto do can now be written. This sample code simply waits for a triggermessage (of message type that is specified in the psySpec for thismodule) by using the plug call <span class="codeCPP">waitForNewMessage(longms)</span>, and prints information about the trigger message whenthe module is woken up. Additionally, a new basic message is create,given to the plug as a message to post using the plug call <span class="codeCPP">addOutputMessage()</span>, and thenpost a message (of message type that is specified in the psySpec forthis module) using the call <span class="codeCPP">sendOutputMessages()</span>:            </p>            <blockquote>              <p class="codeCPP"> Message* triggerMessage;<br>Message* msg<br>int count = 0;<br>while (true) {<br>&nbsp;&nbsp;&nbsp;if ((triggerMessage =tv-&gt;waitForNewMessage(100)) != NULL) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf("\r%s:CppReader received message %s from %s...\n", (char*)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;triggerMessage-&gt;getTimestamp().printTimeMS(),(char*) triggerMessage-&gt;getType(),&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(char*)triggerMessage-&gt;getFrom());<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg = newMessage("", "", "");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plug-&gt;addOutputMessage(msg);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plug-&gt;sendOutputMessages();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fflush(stdout);<br>&nbsp;&nbsp;&nbsp;} else {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!tv-&gt;isServerAvailable())<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf("Psycloneis available but the module has not been awoken");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf("Psycloneis not available"); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;}<br>return 0; </p>            </blockquote>            </td>          </tr>        </tbody>      </table>      <p>&nbsp;</p>      <table align="center" border="0" cellpadding="0" cellspacing="0" width="670">        <tbody>          <tr background="images/grey-bk.gif" bgcolor="#f7f7f7" valign="CENTER">            <td height="30" width="414"><b><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1"><a name="runninginternalcppexamples" id="runninginternalcppexamples"></a>Runningthe provided internal c++ examples</font></font></font></b></td>            <td align="right" width="90">&nbsp;</td>            <td align="right" width="118"><b><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#b9b9b9"><a href="index.html" class="navLink"><b><font face="Verdana, Arial, Helvetica, sans-serif">Back to Index</font></b></a></font></font></b></td>            <td align="right" width="83">&nbsp;</td>          </tr>          <tr bgcolor="#f7f7f7">              <td colspan="4" height="542" valign="top">                 <p>Internal modules are designed to run insidePsyclone for maximum performance and efficiency. They are similar toexternal modules, but somewhat simpler to design, implement andmaintain. </p>            <p><font face="Verdana, Arial, Helvetica, sans-serif">A librarycontains <a href="psycloneManual.html#psy:cranks"> <span class="navLink">crank</span></a> functions,which can be as complex as the designer wants. Cranks share the sameinterface definition, but must have different names. Any number oflibraries can be loaded by Psyclone at the same time.</font> </p>            <p><font face="Verdana, Arial, Helvetica, sans-serif">When anInternal Module is specified in the <a href="psycloneManual.html#psy:psyspec">psySpec</a>file, it may include a crank section. The crank section can list one ormore cranks to be executed. These then reference crank methods in theexternally loaded library. To take an example, a crank 'mycrank',contained in an external library called 'mylib', can be specified inthe psySpec file as</font></p>            <p class="codeXML"><font face="Verdana, Arial, Helvetica, sans-serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;crank name="<span class="dataValue">mylib::mycrank</span>"/&gt;</font></p>                <p><font size="2">Thust, to include a crank function from a third-party                   library in an internal module</font><font size="2"> you will                   need to create a <a href="psycloneManual3.html#psy:psyspec"><span class="navLink">psySpec</span></a>                   and define the <a href="psycloneManual.html#psy:module" class="navLink">module</a>                   using the specific crank function as a crank. For example, to                   define a module which uses the crank function <span class="keyConcept">testCrank1</span>                   located inside the example library called <span class="codeCPP">cm</span>,                   you would specify the module like this: </font></p>                <blockquote>                   <p align="left" class="codeXML"> <span class="codeXML"> &lt;module                     name="</span><span class="dataValue">MyModule</span><span class="codeXML">"                     type=&quot;internal&quot; > <br>                    &nbsp;&nbsp;&lt;description></span><span class="dataValue">This                     module is my first module</span><span class="codeXML">&lt;/description&gt;                     <br>                    &nbsp;&nbsp;&lt;trigger after="</span><span class="dataValue">100</span><span class="codeXML">"                     type="</span><span class="dataValue">Psyclone.System.Ready</span><span class="codeXML">"/&gt;                     <br>                    &nbsp;&nbsp;&lt;crank name="</span><span class="dataValue">cm::testCrank1</span><span class="codeXML">"                     /&gt; <br>                    &nbsp;&nbsp;&lt;post to="</span><span class="dataValue">WB1</span><span class="codeXML">"                     type="</span><span class="dataValue">Some.Message.Type</span><span class="codeXML">"                     /&gt; <br>                    &lt;/module&gt; </span></p>                </blockquote>                <p><font face="Verdana, Arial, Helvetica, sans-serif">This means that                   when the Internal Module that contains this crank specification                   gets <a href="psycloneManual.html#psy:wakeup">awoken</a> with                   a trigger, the triggering message and any retrieved messages                   will be delivered as input to the crank. In return the Internal                   Module expects zero or more output messages, that is, the crank                   may post something as a result of having been awakened.</font></p>                <p><font size="2">To compile the C++ examples for Linux or Mac                   OS X, use the </font><span class="keyConcept">Make file</span><font size="2">                   included with the examples. For Windows you need the Visual                   Studio 6 (.NET project files can be made available). To start                   up the project in Visual Studio, double-click on the <span class="codeCPP">mycmdll.sln</span>                   file. Then build the solution. This will compile and build the                   library file <span class="codeCPP">cm.dll</span>.</font><font size="2">                   </font></p>                </td>          </tr>        </tbody>      </table>        <p>&nbsp;</p>        <table align="center" border="0" cellpadding="2" cellspacing="0" width="670">          <tbody>            <tr bordercolor="#B9B9B9" background="images/grey-bk.gif" bgcolor="#f7f7f7" valign="CENTER">               <td height="30" width="452"><b><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1"><a name="roundrobinexample" id="roundrobinexample"></a><a name="runningroundrobinpsyspec" id="runningroundrobinpsyspec"></a>Running                 the provided roundRobinPsySpec example</font></font></font></b></td>              <td align="right" width="141"><b><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#b9b9b9"><a href="index.html" class="navLink"><b><font face="Verdana, Arial, Helvetica, sans-serif">Back                 to Index</font></b></a></font></font></b></td>              <td align="right" width="77">&nbsp;</td>            </tr>            <tr align="center" bgcolor="#f7f7f7" valign="top">               <td colspan="3" height="1166">                 <p align="left"><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333" size="-1"><strong>If                   you are new to Psyclone this is a good place to start</strong>.                   </font></font></p>                <p align="left"><font face="Verdana, Arial, Helvetica, sans-serif"><font face="Verdana, Arial, Helvetica, sans-serif"><font size="-1">A                   psySpec is an XML file which is used to initialize things. </font></font><font size="-1">                   The psySpec dictates for example which whiteboards and which                   modules to start up, as well as some other things. </font></font></p>                <p align="left"><font face="Verdana, Arial, Helvetica, sans-serif"><font face="Verdana, Arial, Helvetica, sans-serif"><font size="-1"><font face="Verdana, Arial, Helvetica, sans-serif"><font face="Verdana, Arial, Helvetica, sans-serif">T<font size="-1">he                   <span class="keyConcept">roundRobin<strong>PsySpec.xml</strong></span>                   psySpec file is included with Psyclone and reproduced here in                   full, for convenience. </font></font></font></font></font><font color="#333333" size="-1">It                   should take you about 5-10 minutes to go through this example.                   </font></font></p>                <p align="left"><font color="#333333" size="-1" face="Verdana, Arial, Helvetica, sans-serif">The                   file itself looks like this:</font></p>                <blockquote>                   <p align="left" class="codeXML">&lt;psySpec name=&quot;<span class="dataValue">Demonstration                     of Whiteboards, Modules and Messages</span>&quot; version=&quot;1.2&quot;&gt;</p>                  <p align="left"> <span class="codeXML">&nbsp;&nbsp;&lt;global&gt;<br>                    &nbsp;&nbsp;&lt;title&gt;Round-robin psySpec&lt;/title&gt;<br>                    &nbsp;&nbsp;&lt;description&gt;<br>                    &nbsp;&nbsp;&nbsp;&nbsp;This demo shows basic usage of Whiteboards                     Modules and Messages. <br>                    &nbsp;&nbsp;&lt;/description&gt;<br>                    &nbsp;&nbsp;&lt;/global&gt; </span></p>                  <p align="left"><span class="codeXML"> &nbsp;&nbsp;&lt;whiteboard                     name=&quot;</span><span class="dataValue">Whiteboard.1</span><span class="codeXML">&quot;                     maxcount=&quot;</span><span class="dataValue">15000</span><span class="codeXML">&quot;&gt;<br>                    &nbsp;&nbsp;&nbsp;&nbsp;&lt;description&gt;Stores all messages                     from the three round-robin modules.&lt;/description&gt;<br>                    &nbsp;&nbsp;&lt;/whiteboard&gt;</span></p>                  <p align="left" class="codeXML"> &lt;!-- ####################                     ROUND ROBIN MODULES #################### --&gt; </p>                  <p align="left" class="codeXML"> <span class="codeXML">&nbsp;&nbsp;</span>&lt;module                     name=&quot;<span class="dataValue">RoundRobin-1</span>&quot;&gt;<br>                    <span class="codeXML">&nbsp;&nbsp;</span><span class="codeXML">&nbsp;&nbsp;</span>&lt;description&gt;<br>                    <span class="codeXML">&nbsp;&nbsp;</span><span class="codeXML">&nbsp;&nbsp;&nbsp;&nbsp;</span>This                     module gets initially triggered by Psyclone.System.Ready,                     <br>                    <span class="codeXML">&nbsp;&nbsp;</span><span class="codeXML">&nbsp;&nbsp;&nbsp;&nbsp;</span>which                     is posted by Psyclone when it's ready, <br>                    <span class="codeXML">&nbsp;&nbsp;</span><span class="codeXML">&nbsp;&nbsp;</span><span class="codeXML">&nbsp;&nbsp;</span>and                     after that it is triggered by Trigger3 <br>                    <span class="codeXML">&nbsp;&nbsp;</span><span class="codeXML">&nbsp;&nbsp;</span><span class="codeXML">&nbsp;&nbsp;</span>which                     is posted by the RoundRobin-3 module.<br>                    <span class="codeXML">&nbsp;&nbsp;&nbsp;&nbsp;</span>&lt;/description&gt;<br>                    <span class="codeXML">&nbsp;&nbsp;</span><span class="codeXML">&nbsp;&nbsp;</span>&lt;triggers                     from=&quot;Whiteboard.1&quot;&gt;<br>                    <span class="codeXML">&nbsp;&nbsp;</span><span class="codeXML">&nbsp;&nbsp;&nbsp;&nbsp;</span>&lt;trigger                     after=&quot;<span class="dataValue">100</span>&quot; type=&quot;<span class="dataValue">Psyclone.System.Ready</span>&quot;/&gt;<br>                    <span class="codeXML">&nbsp;&nbsp;</span><span class="codeXML">&nbsp;&nbsp;&nbsp;&nbsp;</span>&lt;trigger                     after=&quot;<span class="dataValue">500</span>&quot; type=&quot;<span class="dataValue">Trigger3</span>&quot;/&gt;<br>                    <span class="codeXML">&nbsp;&nbsp;</span><span class="codeXML">&nbsp;&nbsp;</span>&lt;/triggers&gt;<br>                    <span class="codeXML">&nbsp;&nbsp;</span><span class="codeXML">&nbsp;&nbsp;</span>&lt;post                     to=&quot;<span class="dataValue">Whiteboard.1</span>&quot;                     type=&quot;<span class="dataValue">Trigger1</span>&quot; /&gt;<br>                    <span class="codeXML">&nbsp;&nbsp;</span>&lt;/module&gt;</p>                  <p align="left"> <span class="codeXML">&nbsp;&nbsp;&lt;module                     name=&quot;</span><span class="dataValue">RoundRobin-2</span><span class="codeXML">&quot;&gt;<br>                    &nbsp;&nbsp;&nbsp;&nbsp;&lt;description&gt;This module will                     trigger off RoundRobin-1's posting.&lt;/description&gt;<br>                    </span><span class="codeXML"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;trigger                     from=&quot;</span><span class="dataValue">Whiteboard.1</span><span class="codeXML">&quot;                     </span><span class="codeXML">after=&quot;</span><span class="dataValue">500</span><span class="codeXML">&quot;                     type=&quot;</span><span class="dataValue">Trigger1</span><span class="codeXML">&quot;/&gt;<br>                    &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&lt;post to=&quot;</span><span class="dataValue">Whiteboard.1</span><span class="codeXML">&quot;                     type=&quot;</span><span class="dataValue">Trigger2</span><span class="codeXML">&quot;                     /&gt;<br>                    &nbsp;&nbsp;&lt;/module&gt;</span></p>                  <p align="left"><span class="codeXML">&nbsp;&nbsp;&lt;module                     name=&quot;</span><span class="dataValue">RoundRobin-3</span><span class="codeXML">&quot;&gt;<br>                    &nbsp;&nbsp;&nbsp;&nbsp;&lt;description&gt;This module will                     trigger off RoundRobin-2's posting.&lt;/description&gt;<br>                    &nbsp;&nbsp;&nbsp;&nbsp;&lt;trigger from=&quot;</span><span class="dataValue">Whiteboard.1</span><span class="codeXML">&quot;                     after=&quot;</span><span class="dataValue">500</span><span class="codeXML">&quot;                     type=&quot;</span><span class="dataValue">Trigger2</span><span class="codeXML">&quot;/&gt;<br>                    &nbsp;&nbsp;&nbsp;&nbsp;&lt;post to=&quot;</span><span class="dataValue">Whiteboard.1</span><span class="codeXML">&quot;                     type=&quot;</span><span class="dataValue">Trigger3</span><span class="codeXML">&quot;                     /&gt;<br>                    &nbsp;&nbsp;&lt;/module&gt;</span></p>                  <p align="left" class="codeXML">&lt;/psySpec&gt;</p>                </blockquote>                <p align="left"><font face="Verdana, Arial, Helvetica, sans-serif"><font size="-1">                   When Psyclone starts up it can be told to read in this <a href="psycloneManual3.html#spec:thebasics" class="navLink">psySpec</a>.                   </font></font><font face="Verdana, Arial, Helvetica, sans-serif"><font size="-1"><font face="Verdana, Arial, Helvetica, sans-serif"><font face="Verdana, Arial, Helvetica, sans-serif"><font size="-1">Go                   to the <a href="#gettingstarted" class="navLink">specification                   of running Psyclone</a>; use the roundRobinPsySpec.xml as the                   value for the 'spec' <font face="Verdana, Arial, Helvetica, sans-serif"><font size="-1"><font face="Verdana, Arial, Helvetica, sans-serif"><font face="Verdana, Arial, Helvetica, sans-serif"><font size="-1">parameter</font></font></font></font></font>.                   </font></font></font></font></font>                   <map name="MapMapMap">                    <area shape="circle" coords="184,206,9" href="#30mins:intmodule">                    <area shape="circle" coords="206,214,9" href="#30mins:intmodule">                    <area shape="circle" coords="228,202,9" href="#30mins:intmodule">                    <area shape="rect" coords="99,293,252,431" href="#30mins:anotherpsyclone">                    <area shape="rect" coords="297,294,386,396" href="#30mins:satellites">                    <area shape="circle" coords="321,419,13" href="#30mins:extmodule">                    <area shape="circle" coords="367,417,13" href="#30mins:extmodule">                    <area shape="circle" coords="50,335,17" href="#30mins:extmodule">                    <area shape="rect" coords="16,187,69,248" href="#30mins:psyspec">                    <area shape="rect" coords="16,369,68,430" href="#30mins:psyspec">                    <area shape="rect" coords="119,131,159,170" href="#30mins:whiteboard">                    <area shape="rect" coords="179,140,220,181" href="#30mins:whiteboard">                    <area shape="circle" coords="47,154,15" href="#30mins:part1">                    <area shape="circle" coords="267,94,15" href="#30mins:part3">                    <area shape="circle" coords="151,204,14" href="#30mins:part2">                    <area shape="circle" coords="151,272,15" href="#30mins:part4">                    <area shape="circle" coords="345,273,15" href="#30mins:part5">                    <area shape="poly" coords="35,37,50,31,65,36,111,36,131,20,164,34,187,39,187,68,164,75,136,40,124,70,98,56,67,55,49,60,35,51" href="#30mins:micmodule">                    <area shape="poly" coords="326,118,342,104,419,70,573,71,573,208,419,211,331,141" href="#30mins:graphicsmodule">                    <area shape="poly" coords="157,67,140,69,126,91,124,115,131,131,137,113,140,89,153,75" href="#30mins:communication">                    <area shape="poly" coords="173,77,167,84,168,113,180,134,192,140,186,128,179,109,179,85" href="#30mins:communication">                    <area shape="poly" coords="222,149,232,146,273,152,321,142,328,142,328,151,275,166,226,156" href="#30mins:communication">                    <area shape="rect" coords="138,232,218,249" href="#30mins:part1">                  </map>                </p>                <p align="left"><span class="mediumSizeNonConspicuous">READ MORE:                   </span><a href="#gettingstarted" class="navLink">running Psyclone</a>                 </p>                <p align="left"><span class="tutorialSubsectionHeading"><font size="-1">                   </font></span><font size="-1"> <font face="Verdana, Arial, Helvetica, sans-serif">                   If the psySpec specifies <a href="psycloneManual.html#psy:internalmodules" class="navLink">internal                   modules</a>, Psyclone also spawns these. In the roundRobinPsySpec.xml                   file we have defined three internal modules. These modules are                   so that they only use functionality that is built into Psyclone:                   receiving and posting messages.</font></font> </p>                <p align="left"><font size="-1"><font face="Verdana, Arial, Helvetica, sans-serif">By                   default, Psyclone always spawns (creates) the <span class="navLink"><font face="Verdana, Arial, Helvetica, sans-serif"><a href="psycloneManual.html#psy:whiteboard">whiteboard</a></font></span>                   AIRCentral. This is because Psyclone is <a href="http://www.mindmakers.org/openair" class="navLink">OpenAIR</a>                   compliant. </font></font>In the case of the roundRobinPsySpec.xml                   we also create a second whiteboard, <span class="keyConcept">whiteboard.1</span>.                 </p>                <p align="left">When roundRobinPsySpec starts up the modules start                   to post messages, each in turn. This is because they have been                   rigged in the psySpec to trigger each other in a loop: module                   RoundRobin-1 posts a message type which RoundRobin-2 has subscribed                   to, and so on; RoundRobin-1 also subscribes to a message type                   that is posted by RoundRobin-3. Each of the triggers are outfitted                   with a delay, the after= parameter. This means that Psyclone                   will wait for the specified number of milliseconds before waking                   the module up with that trigger.</p>                <p align="left"><font face="Verdana, Arial, Helvetica, sans-serif"><font size="-1"><font face="Verdana, Arial, Helvetica, sans-serif"><span class="mediumSizeNonConspicuous">READ                   MORE: </span><span class="navLink"><a href="#runninginternalcppexamples">psySpec                   internal module example</a> </span></font></font></font><span class="navLink"><a href="psycloneManual3.html#spec:thebasics">writing                   a psySpec</a> <a href="#dominospsyspec">running the dominosPsySpec</a></span></p>                <div align="left"></div></td>            </tr>          </tbody>        </table>        <p>&nbsp;</p>        <table align="center" border="0" cellpadding="2" cellspacing="0" width="670">          <tbody>          <tr bordercolor="#B9B9B9" background="images/grey-bk.gif" bgcolor="#f7f7f7" valign="CENTER">            <td height="30" width="452"><b><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1"><a name="dominosexample"></a><a name="runningdominospsyspec" id="runningdominospsyspec"></a>Runningthe provided dominosPsySpec example</font></font></font></b></td>            <td align="right" width="141"><b><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#b9b9b9"><a href="index.html" class="navLink"><b><font face="Verdana, Arial, Helvetica, sans-serif">Back to Index</font></b></a></font></font></b></td>            <td align="right" width="77">&nbsp;</td>          </tr>          <tr align="center" bgcolor="#f7f7f7" valign="top">            <td colspan="3" height="1243">            <p align="left"><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333" size="-1"><strong>If                   you are new to Psyclone you might first want to look at <a href="#roundrobinexample" class="navLink">Running                   the provided roundRobinPsySpec example</a></strong>. If                   you follow most of the links provided down one level of detail,                   it should take you about 10 minutes to go through all points.                   A good way to proceed is to first go through all the steps,                   and then go back and look further at some of the links provided.</font></font>                 </p>            <p align="left"><span class="tutorialSubsectionHeading"><strong>1. PsycloneStartup</strong></span><font face="Verdana, Arial, Helvetica, sans-serif"><font size="-1"><br>                  When Psyclone starts up it reads in the <a href="#spec:thebasics" class="navLink">psySpec</a>,                   an XML file which is used to initialize. The psySpec dictates                   for example which whiteboards and which modules to start up,                   as well as some other things. </font></font> </p>            <p align="left"><font face="Verdana, Arial, Helvetica, sans-serif"><font size="-1"><font face="Verdana, Arial, Helvetica, sans-serif"><font face="Verdana, Arial, Helvetica, sans-serif">T<font size="-1">he <span class="keyConcept"><strong>dominosPsySpec.xml</strong></span>file is included with Psyclone. Go to the <a href="#gettingstarted" class="navLink">specification of running Psyclone</a>;use the dominosPsySpec.xml as the value for the 'spec' <font face="Verdana, Arial, Helvetica, sans-serif"><font size="-1"><font face="Verdana, Arial, Helvetica, sans-serif"><font face="Verdana, Arial, Helvetica, sans-serif"><font size="-1">parameter</font></font></font></font></font>.            </font></font></font></font></font>            <map name="MapMap">            <area shape="circle" coords="184,206,9" href="#30mins:intmodule">            <area shape="circle" coords="206,214,9" href="#30mins:intmodule">            <area shape="circle" coords="228,202,9" href="#30mins:intmodule">            <area shape="rect" coords="99,293,252,431" href="#30mins:anotherpsyclone">            <area shape="rect" coords="297,294,386,396" href="#30mins:satellites">            <area shape="circle" coords="321,419,13" href="#30mins:extmodule">            <area shape="circle" coords="367,417,13" href="#30mins:extmodule">            <area shape="circle" coords="50,335,17" href="#30mins:extmodule">            <area shape="rect" coords="16,187,69,248" href="#30mins:psyspec">            <area shape="rect" coords="16,369,68,430" href="#30mins:psyspec">            <area shape="rect" coords="119,131,159,170" href="#30mins:whiteboard">            <area shape="rect" coords="179,140,220,181" href="#30mins:whiteboard">            <area shape="circle" coords="47,154,15" href="#30mins:part1">            <area shape="circle" coords="267,94,15" href="#30mins:part3">            <area shape="circle" coords="151,204,14" href="#30mins:part2">            <area shape="circle" coords="151,272,15" href="#30mins:part4">            <area shape="circle" coords="345,273,15" href="#30mins:part5">            <area shape="poly" coords="35,37,50,31,65,36,111,36,131,20,164,34,187,39,187,68,164,75,136,40,124,70,98,56,67,55,49,60,35,51" href="#30mins:micmodule">            <area shape="poly" coords="326,118,342,104,419,70,573,71,573,208,419,211,331,141" href="#30mins:graphicsmodule">            <area shape="poly" coords="157,67,140,69,126,91,124,115,131,131,137,113,140,89,153,75" href="#30mins:communication">            <area shape="poly" coords="173,77,167,84,168,113,180,134,192,140,186,128,179,109,179,85" href="#30mins:communication">            <area shape="poly" coords="222,149,232,146,273,152,321,142,328,142,328,151,275,166,226,156" href="#30mins:communication">            <area shape="rect" coords="138,232,218,249" href="#30mins:part1">            </map>            </p>            <p align="left"><span class="mediumSizeNonConspicuous">READ MORE: </span><a href="#gettingstarted" class="navLink">runningPsyclone</a> </p>                <p align="left"><span class="tutorialSubsectionHeading">2. Spawning                   Internal Modules<font size="-1"><br>                  </font></span><font size="-1"> <font face="Verdana, Arial, Helvetica, sans-serif">                   If the psySpec specifies <a href="psycloneManual.html#psy:internalmodules" class="navLink">internal                   modules</a>, Psyclone also spawns these. In the dominosPsySpec.xml                   file we have defined a few internal modules. These modules have                   very simple functionality &#8212; so simple in fact that                   they only use functionality that is built into Psyclone, that                   of receiving and posting messages.</font></font> </p>            <p align="left"><font size="-1"><font face="Verdana, Arial, Helvetica, sans-serif">By default,Psyclone always spawns (creates) the <span class="navLink"><font face="Verdana, Arial, Helvetica, sans-serif"><a href="psycloneManual.html#psy:whiteboard">whiteboards</a></font></span>AIRCentral, WB1 and WB2. This is because Psyclone is <a href="http://www.mindmakers.org/openair" class="navLink">OpenAIR</a>compliant. </font></font>In the case of thedominosPsySpec.xml it also creates <span class="keyConcept">whiteboard.1</span>and <span class="keyConcept">whiteboard.2</span>. </p>            <p align="left">When dominosPsySpec starts upit creates eight modules. Three of these will continue to post messagesafter the program starts up. This is because they have been rigged inthe psySpec to trigger each other in a loop. </p>            <p align="left"><font face="Verdana, Arial, Helvetica, sans-serif"><font size="-1"><font face="Verdana, Arial, Helvetica, sans-serif"><span class="mediumSizeNonConspicuous">READ MORE: </span><span class="navLink"><a href="#runninginternalcppexamples">psySpecinternal module example</a> </span></font></font></font><span class="navLink"><a href="#spec:thebasics">writinga psySpec</a> </span></p>            <p align="left"><span class="tutorialSubsectionHeading">3. Contexts</span><font face="Verdana, Arial, Helvetica, sans-serif"><font face="Verdana, Arial, Helvetica, sans-serif"><font face="Verdana, Arial, Helvetica, sans-serif"><font size="-1"><font size="-1"><font size="3"><br>            </font> </font></font></font></font></font><a href="psycloneManual.thml#psy:contexts"><span class="navLink">C<strong>ontexts</strong></span></a><font face="Verdana, Arial, Helvetica, sans-serif"><font face="Verdana, Arial, Helvetica, sans-serif"><font face="Verdana, Arial, Helvetica, sans-serif"><font size="-1"><font size="-1"> can be used tomanage the activity of modules in the system. They are a convenient wayto make sure that sets of modules be <span class="keyConcept"><strong>activeduring certain states and not others</strong></span>. Eventhough contexts have certain features of their own that make themspecial, in some ways they can be thought of as global variables. <font face="Verdana, Arial, Helvetica, sans-serif"><font size="-1">Contexts are defined <span class="keyConcept"><strong>hierarchically</strong></span>;in a typical system specific modules are used to post contexts andmanage transition between. Their syntax is<strong> <span class="keyConcept">period-delimited</span></strong>.</font></font></font></font></font></font></font></p>            <p align="left">Once Psyclone is running, goto a browser and <a href="#usingpsyprobe">start up <span class="conceptLink">psyProbe</span></a>, theweb-based interface to Psyclone. This will enable you to open anotherpage, called <span class="keyConcept">contexts+phases page</span>,listed at the top of the main psyProbe page. </p>            <p align="left">Once you have the <a href="psycloneManual.html#psyprobe:contextsandphasespage" class="navLink">contexts+phases</a> page loaded, takea look at the following modules listed there: <strong>Domino-1</strong>,            <strong>Domino-2</strong>, <strong>Domino-3</strong>,            <strong>Domino-40</strong>,<strong>Domino-50</strong> and<strong> Domino-60</strong>.These modules are internal modules. Domino-1, 2 and 3 are set up to <strong>triggereach other</strong> in a cycle, as are Domino-40, 50 and 60,using the <a href="psycloneManual.html#psy:after=" class="navLink">after=</a> parameter of the <a href="psycloneManual.html#psy:triggers" class="navLink">trigger            </a> for each module. </p>                <p align="left">Currently, as you can see in the list of contexts                   at the top of the page, the contexts <strong>System.Ready</strong>                   and <strong>Dominos.Chain-1</strong> are active. Now, using                   the <a href="psycloneManual.html#psyprobe:contextsandphasespage:postcontextsection" class="navLink">post                   context</a> button, you can switch the Dominos context to <strong>Dominos.Chain-2</strong>                   (select this context from the drop-down, and click on <strong>post                   context </strong>button.) When you post Dominos.Chain-1 the                   Dominos.Chain-2 context becomes invalid. (However, if you post                   a context called Dominos.Chain-1.hello the Dominos.Chain-1 will                   still be valid &#8212; the latter subsumes the former.)</p>                <p align="left">Now you should see <strong>Domino-1</strong>,                   <strong>2</strong> and <strong>3</strong> go out of context,                   while the modules <strong>Domino-40</strong>, <strong>50</strong>                   and <strong>60</strong> are in context. You can further verify                   that this is true by going to the <strong>whiteboard pages</strong>                   (click on the whiteboard's name on the main psyProbe page, i.e.                   <strong>Whiteboard.1</strong>), and see that only System.Report                   messages are posted there. If you look at <strong>Whiteboard.2</strong>,                   however, you'll see that the domino chain 2 has started &#8212;                   there are now plenty of messages on Whiteboard.2.</p>            <p align="left"><font face="Verdana, Arial, Helvetica, sans-serif"><font size="-1"><font face="Verdana, Arial, Helvetica, sans-serif"><font face="Verdana, Arial, Helvetica, sans-serif"><font size="-1"><span class="mediumSizeNonConspicuous">READMORE: </span><a href="psycloneManual3.html#spec:contexts" class="navLink">usingcontexts</a></font></font></font></font></font></p>            <p align="left"><a name="spec:phaseexample" id="spec:phaseexample"></a></p>            <p align="left"><font color="#333333" face="Verdana, Arial, Helvetica, sans-serif" size="-1"><span class="tutorialSubsectionHeading">4. Phases</span><font face="Verdana, Arial, Helvetica, sans-serif"><font face="Verdana, Arial, Helvetica, sans-serif"><font face="Verdana, Arial, Helvetica, sans-serif"><font size="-1"><font size="-1"><font size="3"><br>            </font></font></font></font></font></font>Everymodule has one or more <a href="psycloneManual.html#psy:phases"><span class="navLink">phases</span></a>. Phases worklike states in a <strong>sequencer</strong>: A module withonly one phase has only one state while active; a module with two ormore phases cycles through the phases. Typically, a phase is changedimmediately after a module has posted (this can be specified in thepsySpec definition for the module by setting the post parameterphasechange="yes"). A module can also simply post an explicit phasechange. </font></p>            <p align="left"><font color="#333333" face="Verdana, Arial, Helvetica, sans-serif" size="-1">Phases can be <strong>grouped under contexts</strong>.Phases belonging to the same context get activated one after another,like a sequencer. For every phase there may be different triggers; whenthe module is in a particular phase, any message types listed astriggers for that phase will cause the module to get a wakeup if theyappear on the Whiteboard. <br>            <br>The phases are listed in the psySpec (<a href="psycloneManual3.html#spec:phaseexample" class="navLink">example</a>).<br>            <br>When a module has two or more contexts (each with one or more phases),and the context gets switched, the first phase in that context isactivated.</font> </p>            <div align="left">            <p><span class="mediumSizeNonConspicuous">RELATED:</span><font face="Verdana, Arial, Helvetica, sans-serif" size="2">            </font><span class="navLink"><a href="psycloneManual3.html#usingcontexts">using contexts</a> <a href="#usingpsyspec">using psySpec</a> <a href="psycloneManual.html#wakeup">wakeup</a> <a href="psycloneManual.html#psy:triggers">triggers</a> </span></p>            </div>            </td>          </tr>        </tbody>      </table>      <p>&nbsp;</p>        <table align="center" border="0" cellpadding="2" cellspacing="0" width="670">          <tbody>          <tr background="images/grey-bk.gif" bgcolor="#f7f7f7" valign="CENTER">              <td class="tutorialSubsectionHeading" height="30" width="455"><a name="creatingexternaljavamodules" id="creatingexternaljavamodules"></a>Creating                 external modules in Java</td>            <td align="right" width="49">&nbsp;</td>            <td align="right" width="118"><b><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#b9b9b9"><a href="index.html" class="navLink"><b><font face="Verdana, Arial, Helvetica, sans-serif">Back to Index</font></b></a></font></font></b></td>            <td align="right" width="83">&nbsp;</td>          </tr>          <tr bgcolor="#f7f7f7">            <td colspan="4" height="3750" valign="top">            <blockquote>              <p>To read about external modules in general, go <a href="psycloneManual.html#psy:externalmodules" class="navLink">here</a>.              </p>              <p>To write an external module in Java, you willneed the JavaAIRPlug or JavaOpenAIR. (JavaOpenAIR can be downloadedfrom <a href="http://www.mindmakers.org/openair/download" class="navLink">http://www.mindmakers.org/openair/download/</a>).              </p>            </blockquote>            <p> External modules are designed to run outsidePsyclone in separate executables. They are very similar to internalmodules and they can be written in other languages, such as Java. </p>                <p> Any module has two distinct functionalities: message handling                   and message processing. Like internal modules, external modules                   only have to worry about the message processing (called a <a href="psycloneManual.html#psy:crank"><span class="navLink">crank</span></a>),                   because all the message handling (receiving, organizing, posting,                   etc.) is done automatically. </p>            <p> To create an external module in Java one normallywould use an AIR Plug. This is a Java object which can be instantiatedinside any Java program and the plug is used for all communication withPsyclone. </p>            <p> This is an example of a simple Java program andhow to use the plug: </p>            <blockquote>              <p class="codeJava"> import com.cmlabs.air.*;<br>public class MyModule {<br>public static void main(String[] args) {<br>// while (poster.isConnected()) {<br>JavaAIRPlug plug = new JavaAIRPlug("MyModule", "localhost", 10000);<br>if (!plug.init()) {<br>&nbsp; System.out.println("Could not connect to Psyclone");<br>&nbsp; System.exit(0);<br>&nbsp; }<br>Message triggerMessage;<br>Message msg;<br>&nbsp;&nbsp;&nbsp;&nbsp; <br>while (true) {<br>&nbsp; if ((triggerMessage = plug.waitForNewMessage(3000)) == null){<br>&nbsp; &nbsp; // ... processing ... //<br>&nbsp; &nbsp; msg = new Message("", "", "My.First.Output");<br>&nbsp; &nbsp; plug.addOutputMessage(msg);<br>&nbsp; &nbsp; plug.sendOutputMessages();<br>&nbsp; &nbsp; }<br>&nbsp; else {<br>&nbsp; &nbsp; // ... do something else for a while ... //<br>&nbsp; &nbsp; }<br>&nbsp; }<br>}<br>}</p>            </blockquote>            <p> This program assumes that Psyclone is running onthe local computer on the standard Psyclone port 10000. </p>                <p> For Psyclone to use the module, you will need to tell Psyclone                   about it. You do this via an XML definition like this: </p>                <blockquote>                   <p class="codeXML"> &lt;module name="<span class="dataValue">MyFirstModule</span>"                     type=&quot;<span class="dataValue">external</span>&quot; &gt;<br>                    &lt;context name="<span class="dataValue">Psyclone.System.Ready</span>"&gt;<br>                    &nbsp; &nbsp; &lt;phase name="<span class="dataValue">Default</span>"&gt;<br>                    &nbsp; &nbsp; &nbsp;&nbsp;&lt;trigger from="<span class="dataValue">AIRCentral</span>"                     type="<span class="dataValue">My.First.Type</span>" /&gt;<br>                    &nbsp; &nbsp; &nbsp;&nbsp;&lt;post to="<span class="dataValue">AIRCentral</span>"                     type="<span class="dataValue">My.First.Output</span>" /&gt;<br>                    &nbsp; &nbsp; &lt;/phase&gt;<br>                    &lt;/context&gt;<br>                    &lt;/module&gt;</p>            </blockquote>                <p>This specification can be put into the central psySpec configuration                   file and read in by Psyclone at startup. Alternatively it can                   be sent to Psyclone at runtime, in the conten of a message;                   the message type must be <span class="keyConcept">Psyclone.System.Create.Module</span>.                   (Destroy modules by sending a message type <span class="keyConcept">Psyclone.System.Destroy.Module</span>,                   with the name of the module as content, encapsulated in the                   <span class="codeXML">&lt;module&gt; </span>tag but without                   further content.) </p>                <p>Unless you specify a command that will automatically start                   up your module (using the <span class="codeXML">&lt;executable&gt;</span>                   tag) you will need to start up your external module manually                   after you start up Psyclone. </p>            <p> Note that you need to use the <span class="keyConcept">&lt;executable /&gt;</span>tag to tell Psyclone that this is an external module. Otherwise,Psyclone will create it as an internal module. In a later tutorial youcan see how to fill in the &lt;executable&gt; tag to <a href="psycloneManual3.html#automaticstartup" class="navLink">automaticallystart up your module</a>. </p>            <p> Now Psyclone knows that when any message withtype My.First.Type is posted to the Whiteboard AIRCentral, your modulewith the name MyFirstModule should be woken up with this message. </p>            <p> In most cases you probably want to do a bit morein your module. The Plug object is a communication device, which youcan use to get the triggering message and any other messages which mayhave been delivered if you asked for it in the psySpec using the&lt;retrieve&gt; tag (see below). If you post messages usingthe Plug the messages are automatically sent to the correctdestinations. </p>                <p> When this empty message is posted, the :from                   and the :to fields are automatically filled in                   and a copy is sent to every destination Whiteboard defined in                   the psySpec, each with the correct type filled in. For example,                   if the psySpec had defined two post destinations: </p>            <blockquote>              <p class="codeXML"> &lt;posts&gt;<br>&nbsp; &lt;post to="<span class="dataValue">AIRCentral</span>"type="<span class="dataValue">My.Second.Type</span>"/&gt;<br>&nbsp; &lt;post to="<span class="dataValue">AIRCentral</span>"type="<span class="dataValue">My.Third.Type</span>"/&gt;<br>&lt;/posts&gt;</p>            </blockquote>            <p> the AirCentral whiteboard would receive twomessages, one with type My.Second.Type and one with My.Third.Type. </p>            <p> If, however, the function had created a messagelike this: </p>            <blockquote>              <p class="codeJava"> msg = new Message("","", "My.Second.Type");</p>            </blockquote>            <p> only one message would be sent out, as only thefirst post matches the type. Likewise, had the message been createdwith </p>            <blockquote>              <p class="codeJava"> msg = new Message("","", "My.Other.Type");</p>            </blockquote>            <p> no message would be sent out. </p>            <p> If you wish to bypass the post section manually,you can always do: </p>            <blockquote>              <p class="codeJava"> msg = new Message("","MyOtherWB", "My.Other.Type");</p>            </blockquote>            <p> in which case only one message would be sent tothe MyOtherWB Whiteboard. </p>            <p> When you in the psySpec specify which messagetypes will trigger your module you may wish to retrieve additionalmessages from the same or other Whiteboards to be delivered along sidethe triggering message: </p>            <blockquote>              <p class="codeXML"> ...<br>&lt;triggers&gt;<br>&nbsp; &lt;trigger from="<span class="dataValue">AIRCentral</span>"type="<span class="dataValue">My.First.Type</span>"/&gt;<br>&lt;/triggers&gt;<br>&lt;retrieves&gt;<br>&nbsp; &lt;retrieve from="<span class="dataValue">BBX</span>"type="<span class="dataValue">Input.Sens.UniM.Hear</span>"/&gt;<br>&nbsp; &lt;retrieve from="<span class="dataValue">BBX</span>"type="<span class="dataValue">Input.Person.Found.True</span>"&gt;<br>&nbsp; &nbsp;&nbsp;&nbsp;&lt;latest&gt;<span class="dataValue">10</span>&lt;/latest&gt;<br>&nbsp; &nbsp;&nbsp;&nbsp;&lt;lastmsec&gt;<span class="dataValue">200</span>&lt;/lastmsec&gt;<br>&nbsp; &lt;/retrieve&gt; <br>&lt;/retrieves&gt;<br>...</p>            </blockquote>            <p> In your code, you can read these additionalmessages, if any, by asking the Messenger object: </p>            <blockquote>              <p class="codeJava"> // Get the currentnumber of retrieved messages<br>int getRetrievedMessageCount();<br>// Get a specific retrieved message<br>Message getRetrievedMessage(int pos);<br>// Get the full collection of the retrieved messages<br>ObjectCollection getAllRetrievedMessages();</p>            </blockquote>            <p> Should you want to manually retrieve messagesfrom the crank without specifying this in the psySpec, you can ask theMessenger object: </p>            <blockquote>              <p class="codeJava"> // Retrieve additionalmessages from a source<br>ObjectCollection retrieveMessages(String retrieveFrom, StringretrieveSpecXML);</p>            </blockquote>            <p> where retrieveSpecXML uses the same format as youwould have used in the psySpec including the surrounding <span class="codeXML">&lt;retrieves&gt;&hellip;&lt;/retrieves&gt;</span>.            </p>            <p> You do not have to register cranks for externalmodules, but if you do it is a good way of telling your module what todo with a message. If we add a crank in the psySpec like this: </p>            <blockquote>                  <p class="codeXML"> &lt;module name="<span class="dataValue">MyFirstModule</span>"                     type=&quot;<span class="dataValue">external</span>&quot;&gt;<br>&nbsp; &lt;context name="<span class="dataValue">Psyclone.System.Ready</span>"&gt;<br>&nbsp; &nbsp; &lt;phase name="<span class="dataValue">Default</span>"&gt;<br>&nbsp; &nbsp; &nbsp; &lt;triggers&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &lt;trigger from="<span class="dataValue">AIRCentral</span>" type="<span class="dataValue">My.First.Type</span>" /&gt;<br>&nbsp; &nbsp; &nbsp; &lt;/triggers&gt;<br>&nbsp; &nbsp; &nbsp; &lt;crank name="<span class="dataValue">MyFirstModuleCrank</span>" /&gt;<br>&nbsp; &nbsp; &nbsp; &lt;posts&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &lt;post to="<span class="dataValue">WB1</span>" type="<span class="dataValue">My.First.Output</span>" /&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &lt;post to="<span class="dataValue">WB2</span>" type="<span class="dataValue">My.Second.Output</span>" /&gt;<br>&nbsp; &nbsp; &nbsp; &lt;/posts&gt;<br>&nbsp; &nbsp; &lt;/phase&gt;<br>&nbsp; &lt;/context&gt;<br>&lt;/module&gt;</p>            </blockquote>            <p> we can now slightly extend our code to ask forthe name of the crank after being woken up by the trigger message: </p>            <blockquote>              <p class="codeJava"> import com.cmlabs.air.*;<br>public class MyModule {<br>public static void main(String[] args) {<br>// while (poster.isConnected()) {<br>JavaAIRPlug plug = new JavaAIRPlug("MyModule", "localhost", 10000);<br>if (!plug.init()) {<br>&nbsp; System.out.println("Could not connect to Psyclone");<br>&nbsp; System.exit(0);<br>&nbsp; }<br>Message triggerMessage;<br>Message msg;<br>&nbsp;&nbsp;&nbsp;&nbsp; <br>while (true) {<br>&nbsp; if ((triggerMessage = plug.waitForNewMessage(3000)) == null){<br>&nbsp; &nbsp; if(plug.getCrankName().equals("MyFirstModuleCrank")) {<br>&nbsp; &nbsp; &nbsp; // ... processing ... //<br>&nbsp; &nbsp; &nbsp; msg = new Message("", "","My.First.Output");<br>&nbsp; &nbsp; &nbsp; plug.addOutputMessage(msg);<br>&nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; else if(plug.getCrankName().equals("MySecondModuleCrank")) {<br>&nbsp; &nbsp; &nbsp; // ... processing ... //<br>&nbsp; &nbsp; &nbsp; msg = new Message("", "","My.Second.Output");<br>&nbsp; &nbsp; &nbsp; plug.addOutputMessage(msg);<br>&nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; plug.sendOutputMessages();<br>&nbsp; }<br>&nbsp; else {<br>&nbsp; &nbsp; // ... do something else for a while ... //<br>&nbsp; &nbsp; }<br>&nbsp; }<br>}<br>}</p>            </blockquote>            <p> Note that the module will now post its output toWhiteboard WB1 if the crank is MyFirstModuleCrank, and to WhiteboardWB2 if the crank is equal to MySecondModuleCrank. </p>            <p>After receiving a wakeup message a module can ask:            </p>            <blockquote>              <p class="codeJava"> getTriggerAlias()</p>            </blockquote>            <p> which will return the alias of the triggermessage, or the message type if &lt;trigger&gt; does not havean alias. By default, the name parameter will be the type if notspecified. </p>            <p>When posting you can use: </p>            <blockquote>              <p class="codeJava">postOutputMessage(Message*msg)</p>            </blockquote>            <p> and </p>            <blockquote>              <p class="codeJava">postOutputMessage(Message*msg, JString destination) </p>            </blockquote>                <p>The former is shorthand for first adding to <span class="keyConcept">output</span>                   and then sending <span class="keyConcept">output</span>. The                   second allows you to post to a named alias &lt;post alias="xyz"&gt;                   &#8212; so if you use <span class="codeJava">postOutputMessage(Message*                   msg, "xyz")</span> the post entry with the xyz alias will be                   chosen. Alternatively, you can specify the type in a &lt;post&gt;                   the same way: </p>            <blockquote>              <p class="codeJava">postOutputMessage(Message* msg, "my.type")</p>            </blockquote>            <p>If you merely wish to post a message to allwhiteboards: </p>            <blockquote>              <p class="codeJava"> msg = new Message("","", "")<br>addoutputmessage(msg)<br>sendoutputmessages()</p>            </blockquote>            <p> You can call one method which will do all this: </p>            <blockquote>              <p class="codeJava">postOutputMessage(newMessage())</p>            </blockquote>            <p>You can set the priority of a message by doing</p>            <blockquote>              <p class="codeJava">msg.setPriority(3.3)</p>            </blockquote>                <p>where 3.3 is a floating-point number.</p>            </td>          </tr>        </tbody>      </table>      <p>&nbsp;</p>        <table align="center" bgcolor="#ffffff" border="0" cellpadding="2" cellspacing="0" width="670">          <tbody>          <tr background="images/grey-bk.gif" valign="CENTER">            <td class="tutorialSubsectionHeading" bgcolor="#f7f7f7" height="30" width="387"><a name="creatingexternalcppmodules" id="creatingexternalcppmodules"></a>Creating externalmodules in C++</td>            <td align="right" bgcolor="#f7f7f7" width="91">&nbsp;</td>            <td align="right" bgcolor="#f7f7f7" width="112"><b><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#b9b9b9"><a href="index.html" class="navLink"><b><font face="Verdana, Arial, Helvetica, sans-serif">Back to Index</font></b></a></font></font></b></td>            <td align="right" bgcolor="#f7f7f7" width="80">&nbsp;</td>          </tr>          <tr>              <td colspan="4" height="3028" valign="top">                 <p>To read about external modules in general, go <a href="psycloneManual.html#psy:externalmodules" class="navLink">here</a>.            </p>            <p>To write an external module in C++, you will needthe CppAIRPlug. (If CppAIRPlug was not included with this distributionyou can download the plug by going to <a href="http://www.cmlabs.com/psyclone/download/" class="navLink">http://www.cmlabs.com/psyclone/download/</a>,and selecting the platform that you are developing your external moduleon). </p>            <p> External modules are designed to run outsidePsyclone in separate executables. They are very similar to internalmodules and they can be written in other languages, such as Java. </p>            <p> Any module has two distinct functionalities,namely message handling and message processing. Like internal modules,external modules only have to worry about the message processing (orcrank, as we call it), because all the message handling (receiving,organizing, posting, etc.) is done automatically. </p>            <p> To create an external module in C++ one normallywould use an AIRPlug. This is a C++ object which can be instantiatedinside any C++ program and the plug is used for all communication withPsyclone. </p>            <p> This is an example of a simple C++ program andhow to use the plug: </p>            <blockquote>              <p class="codeCPP"> int main(int argc, char*argv[]) {<br>&nbsp;&nbsp;&nbsp;CppAIRPlug plug = newCppAIRPlug("MyFirstModule", "localhost", 10000);<br>&nbsp;&nbsp;&nbsp;if (!plug-&gt;init()) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf("Couldnot connect to Psyclone\n\n");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return -1;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;Message* triggerMessage;<br>&nbsp;&nbsp;&nbsp;Message* msg;<br>&nbsp;&nbsp;&nbsp;while (true) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if((triggerMessage = plug-&gt;waitForNewMessage(3000)) == NULL) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// ...processing ... //<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg = newMessage("", "", "");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plug-&gt;addOutputMessage(msg);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plug-&gt;sendOutputMessages();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;else {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// ... dosomething else for a while ... //<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;}<br>return 0;<br>}</p>            </blockquote>            <p> This program assumes that Psyclone is running onthe local computer on the standard Psyclone port 10000. </p>                <p> For Psyclone to use the module, you will need to tell Psyclone                   about it. You do this via an XML definition like this: </p>            <blockquote>                  <p class="codeXML"> &lt;module name="<span class="dataValue">MyFirstModule</span>"                     type=&quot;<span class="dataValue">external</span>&quot; &gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;executable/&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;description&gt;&lt;/description&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;context name="<span class="dataValue">Psyclone.System.Ready</span>"&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;phasename="<span class="dataValue">Default</span>"&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;triggers&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;triggerfrom="<span class="dataValue">AIRCentral</span>"type="<span class="dataValue">My.First.Type</span>"/&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/triggers&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;posts&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;postto="<span class="dataValue">AIRCentral</span>" type="<span class="dataValue">My.First.Output</span>" /&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/posts&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/phase&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/context&gt;<br>&lt;/module&gt;</p>            </blockquote>                <p>This specification can be put into the central psySpec configuration                   file and read in by Psyclone at startup. Alternatively it can                   be sent to Psyclone at runtime, in the conten of a message;                   the message type must be <span class="keyConcept">Psyclone.System.Create.Module</span>.                   (Destroy modules by sending a message type <span class="keyConcept">Psyclone.System.Destroy.Module</span>,                   with the name of the module as content, encapsulated in the                   <span class="codeXML">&lt;module&gt; </span>tag but without                   further content.) </p>                <p>Unless you specify a command that will automatically start                   up your module (using the <span class="codeXML">&lt;executable&gt;</span>                   tag) you will need to start up your external module manually                   after you start up Psyclone. </p>            <p> Note that you need to use the <span class="codeXML">&lt;executable /&gt;</span>tag to tell Psyclone that this is an external module. Otherwise,Psyclone will create it as an internal module. In a later tutorial youcan see how to fill in the <span class="codeXML">&lt;executable&gt;</span>tag to automatically start up your module. </p>            <p> Now Psyclone knows that when any message withtype My.First.Type is posted to the Whiteboard <a href="psycloneManual.html#psy:aircentral" class="navLink">AIRCentral</a>,your module with the name MyFirstModule should be woken up with thismessage. </p>            <p> In most cases you probably want to do a bit morein your module. The Plug object is a communication device, which youcan use to get the triggering message and any other messages which mayhave been delivered if you asked for it in the psySpec using the <span class="codeXML">&lt;retrieve&gt;</span> tag(see below). If you post messages using the Plug the messages areautomatically sent to the correct destinations. </p>                <p> When this empty message is posted, the :from                   and the :to fields are automatically filled in                   and a copy is sent to every destination Whiteboard defined in                   the psySpec, each with the correct type filled in. For example,                   if the psySpec had defined two post destinations </p>            <blockquote>              <p class="codeXML"> &lt;posts&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;post to="<span class="dataValue">AIRCentral</span>" type="<span class="dataValue">My.Second.Type</span>" /&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;post to="<span class="dataValue">AIRCentral</span>" type="<span class="dataValue">My.Third.Type</span>" /&gt;<br>&lt;/posts&gt;</p>            </blockquote>            <p> the AirCentral whiteboard would receive twomessages, one with type My.Second.Type and one with My.Third.Type. </p>            <p> If, however, the function had created a messagelike this </p>            <blockquote>              <p class="codeCPP"> msg = new Message("","", "My.Second.Type");</p>            </blockquote>            <p> only one message would be sent out, as only thefirst post matches the type. Likewise, had the message been created with</p>            <blockquote>              <p class="codeCPP"> msg = new Message("","", "My.Other.Type");</p>            </blockquote>            <p> no message would be sent out.</p>            <p> If you wish to bypass the post section manually,you can always do </p>            <blockquote>              <p class="codeCPP"> msg = new Message("","MyOtherWB", "My.Other.Type");</p>            </blockquote>            <p> in which case only one message would be sent tothe MyOtherWB Whiteboard. </p>            <p> When you specify in the psySpec which messagetypes will trigger your module you may wish to retrieve additionalmessages from the same or other Whiteboards to be delivered along sidethe triggering message: </p>            <blockquote>              <p class="codeXML"> ...<br>&lt;triggers&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;trigger from="<span class="dataValue">AIRCentral</span>" type="<span class="dataValue">My.First.Type</span>" /&gt;<br>&lt;/triggers&gt;<br>&lt;retrieves&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;retrieve from="<span class="dataValue">BBX</span>" type="<span class="dataValue">Input.Sens.UniM.Hear</span>"/&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;retrieve from="<span class="dataValue">BBX</span>" type="<span class="dataValue">Input.Person.Found.True</span>"&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;latest&gt;<span class="dataValue">10</span>&lt;/latest&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;lastmsec&gt;<span class="dataValue">200</span>&lt;/lastmsec&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/retrieve&gt; <br>&lt;/retrieves&gt;<br>...</p>            </blockquote>            <p> In your code, you can read these additionalmessages, if any, by asking the Messenger object: </p>            <blockquote>              <p class="codeCPP"> // Get the currentnumber of retrieved messages<br>int getRetrievedMessageCount();<br>// Get a specific retrieved message<br>Message* getRetrievedMessage(int pos);<br>// Get the full collection of the retrieved messages<br>ObjectCollection* getAllRetrievedMessages();</p>            </blockquote>            <p> Should you want to manually retrieve messagesfrom the crank without specifying this in the psySpec, you can ask theMessenger object: </p>            <blockquote>              <p class="codeCPP"> // Retrieve additionalmessages from a source<br>ObjectCollection* retrieveMessages(const JString&amp; retrieveFrom,const JString&amp; retrieveSpecXML);</p>            </blockquote>                <p> where retrieveSpecXML uses the same format as you would have                   used in the psySpec including the surrounding <span class="codeXML">&lt;retrieves&gt;&hellip;                   &lt;/retrieves&gt;</span>. </p>            <blockquote>              <p> You do not have to register cranks for externalmodules, but if you do it is a good way of telling your module what todo with a message. If we add a crank in the psySpec like this:</p>                  <p class="codeXML"> &lt;module name="<span class="dataValue">MyFirstModule</span>"                     type=&quot;<span class="dataValue">external</span>&quot;&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;description&gt;&lt;/description&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;context name="<span class="dataValue">Psyclone.System.Ready</span>"&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;phasename="<span class="dataValue">Default</span>"&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;triggers&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;triggerfrom="<span class="dataValue">AIRCentral</span>"type="<span class="dataValue">My.First.Type</span>"/&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/triggers&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;crankname="<span class="dataValue">MyFirstModuleCrank</span>"/&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;posts&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;postto="<span class="dataValue">WB1</span>" type="<span class="dataValue">My.First.Output</span>" /&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;postto="<span class="dataValue">WB2</span>" type="<span class="dataValue">My.Second.Output</span>" /&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/posts&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/phase&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/context&gt;<br>&lt;/module&gt;</p>            </blockquote>            <p> we can now slightly extend our code to ask forthe name of the crank after being woken up by the trigger message: </p>            <blockquote>              <p class="codeCPP"> while (true) {<br>&nbsp;&nbsp;&nbsp;&nbsp;if ((triggerMessage =plug-&gt;waitForNewMessage(3000)) == NULL) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//... processing ... //<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(plug-&gt;getCrankName().equals("MyFirstModuleCrank")) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//... processing ... //<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg= new Message("", "", "My.First.Output");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plug-&gt;addOutputMessage(msg);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elseif (plug-&gt;getCrankName().equals("MySecondModuleCrank")) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//... processing ... //<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg= new Message("", "", "My.Second.Output");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plug-&gt;addOutputMessage(msg);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plug-&gt;sendOutputMessages();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;else {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//... do something else for a while ... //<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>} </p>            </blockquote>            <p> Note that the module will now post its output toWhiteboard <span class="keyConcept">WB1</span> ifthe crank is <span class="keyConcept">MyFirstModuleCrank</span>,and to whiteboard <span class="keyConcept">WB2</span>if the crank is equal to <span class="keyConcept">MySecondModuleCrank</span>.            </p>            </td>          </tr>        </tbody>      </table>      <p>&nbsp;</p>        <table align="center" bgcolor="#ffffff" border="0" cellpadding="2" cellspacing="0" height="1%" width="668">          <tbody>          <tr background="images/grey-bk.gif" bgcolor="#f7f7f7" valign="CENTER">            <td class="tutorialSubsectionHeading" height="30" width="361"><a name="creatinginternalcppmodules" id="creatinginternalcppmodules"></a>Creating internalc++ modules</td>            <td align="right" width="117">&nbsp;</td>            <td align="right" width="111"><b><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#b9b9b9"><a href="index.html" class="navLink"><b><font face="Verdana, Arial, Helvetica, sans-serif">Back to Index</font></b></a></font></font></b></td>            <td align="right" width="79">&nbsp;</td>          </tr>          <tr bgcolor="#f7f7f7">              <td colspan="4" valign="top">                 <p>Internal modules are designed to run insidePsyclone for maximum performance and efficiency. They are similar toexternal modules, but simpler to design, implement and maintain. <span class="mediumSizeNonConspicuous">(However, they do have <a href="psycloneManual3.html#dlllimitations" class="navLink">limitations</a>related to dynamically loaded libraries.) </span> </p>            <p>Internal C++ modules are developed using the <a href="psycloneManual.html#psy:psyclonesdk"><span class="navLink">Psyclone SDK</span></a>, whichis provided with <a href="psycloneManual.html#psy:psyclonepro" class="navLink">PsyclonePro</a> distributions. </p>                <p>Any module has two distinct functionalities, namely message reception/handling                   and subsequent processing &#8212; also called a <a href="psycloneManual.html#psy:crank" class="navLink">crank</a>.                   Internal modules only have to worry about the crank, because                   all the message handling (receiving, organizing, posting, etc.)                   is done automatically. &nbsp; </p>            <p> To create an internal module one has to define acrank which will process incoming messages and generate outputmessages. &nbsp; </p>            <p> This is an example of the crank function for aninternal module, which just prints Hello World to the screen: </p>            <blockquote>              <p><span class="codeCPP">intMyFirstModuleCrank(Messenger* messenger) {<br>&nbsp;&nbsp; printf("Hello World");<br>&nbsp;&nbsp; return 0;<br>}</span></p>            </blockquote>            <p>All you need to do is put this into the cranksfile in the Psyclone SDK (<span class="keyConcept">cranks.cpp</span>and <span class="keyConcept">cranks.h</span> in thedefault library called <span class="keyConcept">cm</span>),recompile and now you have an internal module. <b><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#333333"><font size="-1"><a name="spec:crankexample" id="spec:crankexample"></a></font></font></font></b>            </p>                <p> For Psyclone to use the module, you will need to tell Psyclone                   about it. You do this via an XML definition like this: </p>                 <p> <span class="codeXML">&nbsp;&nbsp; &lt;module name="</span><span class="dataValue">MyFirstModule</span><span class="codeXML">"                   type=&quot;</span><span class="dataValue">internal</span><span class="codeXML">&quot;                   &gt;<br>                  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;description&gt;&lt;/description&gt;<br>                  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;context name="</span><span class="dataValue">Psyclone.System.Ready</span><span class="codeXML">"&gt;<br>                  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                   &lt;phase name="</span><span class="dataValue">Default</span><span class="codeXML">"&gt;<br>                  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                   &lt;triggers&gt;<br>                  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                   &nbsp;&nbsp;&nbsp;&lt;trigger from="</span><span class="dataValue">WB1</span><span class="codeXML">"                   type="</span><span class="dataValue">My.First.Type</span><span class="codeXML">"                   /&gt;<br>                  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                   &lt;/triggers&gt;<br>                  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                   &lt;crank name="</span><span class="dataValue">cm::MyFirstModuleCrank</span><span class="codeXML">"                   /&gt;<br>                  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                   &lt;posts&gt;<br>                  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                   &lt;post to="</span><span class="dataValue">WB1</span><span class="codeXML">"                   type="</span><span class="dataValue">My.Second.Type</span><span class="codeXML">"                   /&gt;<br>                  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                   &lt;/posts&gt;<br>                  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                   &lt;/phase&gt;<br>                  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/context&gt;<br>                  &nbsp;&nbsp; &lt;/module&gt;</span> </p>                <p>This specification can be put into the central psySpec configuration                   file and read in by Psyclone at startup. Alternatively it can                   be sent to Psyclone at runtime, in the conten of a message;                   the message type must be <span class="keyConcept">Psyclone.System.Create.Module</span>.                   (Destroy modules by sending a message type <span class="keyConcept">Psyclone.System.Destroy.Module</span>,                   with the name of the module as content, encapsulated in the                   <span class="codeXML">&lt;module&gt; </span>tag but without                   further content.) </p>                <p>Now Psyclone knows that when any message with type <span class="keyConcept">My.First.Type</span>                   is posted to the Whiteboard WB1, your module with the name <span class="keyConcept">MyFirstModule</span>                   should be woken up with this message. This will in turn automatically                   call the <span class="keyConcept">MyFirstModuleCrank</span>                   function in the library cm you created above and hence print                   &quot;Hello World&quot; to the console. </p>            <p> In most cases you probably want to do a bit morein your module. The Messenger object which is passed to the function isa communication device, which you can use to get the triggering messageand any other messages which may have been delivered if you asked forit in the psySpec using the &lt;retrieve&gt; tag (see below).If you post messages using the Messenger the messages are automaticallysent to the correct destinations. </p>            <p> Here is an example of a slightly more advancedversion of the crank function above: </p>            <p><span class="codeCPP">&nbsp;&nbsp;&nbsp;int MyFirstModuleCrank (Messenger*messenger) {<br>&nbsp;<br>&nbsp;&nbsp; if (messenger == NULL)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return -1;<br>&nbsp;<br>&nbsp;&nbsp; Message* triggerMessage;<br>&nbsp;&nbsp; Message* msg;<br>&nbsp;&nbsp; while (messenger-&gt;shouldContinueRunning()) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(messenger-&gt;waitForNewMessage(50)) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( (triggerMessage = messenger-&gt;getTriggerMessage()) != NULL) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp; Do something with the trigger message...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg = new Message("", "", "");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;messenger-&gt;addOutputMessage(msg);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;messenger-&gt;sendOutputMessages();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp; return 0;<br>&nbsp;&nbsp;&nbsp;}</span> </p>            <p> Now the module sends out one message each time itis woken up. You may notice that instead of returning, the modulechooses to stay inside the function until the Messenger says that itshould not continue running any longer. </p>                <p> When this empty message is posted, the :<span class="keyConcept">from</span> and                   the :<span class="keyConcept">to</span> fields                   are automatically filled in and a copy is sent to every destination                   Whiteboard defined in the psySpec, each with the correct type                   filled in. For example, if the psySpec had defined two post                   destinations </p>            <p> <span class="codeXML">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;posts&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;post to="</span><span class="dataValue">WB1</span><span class="codeXML">" type="</span><span class="dataValue">My.Second.Type</span><span class="codeXML">" /&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;post to="</span><span class="dataValue">WB1</span><span class="codeXML">" type="</span><span class="dataValue">My.Third.Type</span><span class="codeXML">" /&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/posts&gt; </span> </p>            <p>the WB1 Whiteboard would receive two messages, onewith type My.Second.Type and one with My.Third.Type. </p>            <p> If, however, the function had created a messagelike this </p>            <p> <span class="codeCPP">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg= new Message("", "", "My.Second.Type");</span> </p>            <p> only one message would be sent out, as only thefirst post matches the type. Likewise, had the message been createdwith </p>            <p> <span class="codeCPP">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg= new Message("", "", "My.Other.Type");</span> </p>            <p> no message would be sent out. </p>            <p> If you wish to bypass the post section manually,you can always do </p>            <p>&nbsp;<span class="codeCPP">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg= new Message("", "MyOtherWB", "My.Other.Type");</span> </p>            <p> in which case only one message would be sent tothe MyOtherWB Whiteboard.&nbsp; </p>            <p> When you in the psySpec specify which messagetypes will trigger your module you may wish to retrieve additionalmessages from the same or other Whiteboards to be delivered along sidethe triggering message: </p>            <blockquote>              <p>&nbsp;<span class="codeXML">&nbsp;...<br>&nbsp;&nbsp; &lt;triggers&gt;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;triggerfrom="</span><span class="dataValue">WB1</span><span class="codeXML">" type="</span><span class="dataValue">My.First.Type</span><span class="codeXML">" /&gt;<br>&nbsp;&nbsp; &lt;/triggers&gt;<br>&nbsp;&nbsp; &lt;retrieves&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;retrievefrom="</span><span class="dataValue">BBX</span><span class="codeXML">" type="</span><span class="dataValue">Input.Sens.UniM.Hear</span><span class="codeXML">"/&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;retrievefrom="</span><span class="dataValue">BBX</span><span class="codeXML">" type="</span><span class="dataValue">Input.Person.Found.True</span><span class="codeXML">"&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;latest&gt;</span><span class="dataValue">10</span><span class="codeXML">&lt;/latest&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;lastmsec&gt;</span><span class="dataValue">200</span><span class="codeXML">&lt;/lastmsec&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/retrieve&gt; <br>&nbsp;&nbsp; &lt;/retrieves&gt;<br>&nbsp;&nbsp; &lt;crank name="</span><span class="dataValue">cm::MyFirstModuleCrank</span><span class="codeXML">" /&gt;<br>&nbsp;&nbsp; ...</span></p>            </blockquote>            <p> In your crank code, you can read these additionalmessages, if any, by asking the Messenger object: </p>            <p> &nbsp;<span class="codeCPP">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Get the current number of retrieved messages<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; intgetRetrievedMessageCount();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Get aspecific retrieved message<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Message*getRetrievedMessage(int pos);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Get thefull collection of the retrieved messages<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ObjectCollection* getAllRetrievedMessages();</span> </p>            <p> Should you want to manually retrieve messagesfrom the crank without specifying this in the psySpec, you can ask theMessenger object: </p>            <p> &nbsp;<span class="codeCPP">&nbsp;// Retrieve additional messages from a source<br>&nbsp;&nbsp; ObjectCollection* retrieveMessages(constJString&amp; retrieveFrom, <br>&nbsp;&nbsp;&nbsp; const JString&amp; retrieveSpecXML);</span>            </p>            <p> where retrieveSpecXML uses the same format as youwould have used in the psySpec.&nbsp; </p>                <p class="mediumSizeNonConspicuous"><a name="dlllimitations"></a>Note:                   The nature of dynamically loaded libraries where they are loaded                   and unloaded periodically means that static and global variables                   loose their meaning. When creating internal crank functions                   do not use global or static variables in your code. Furthermore,                   on some UNIX systems such as Linux you will get errors when                   trying to load a library with static or global variables, usually                   complaining about an undefined symbol: <span class="codeCPP">__dso_handle</span>.                   If you see this, go through your code and remove all global                   and static variables.</p>            </td>          </tr>        </tbody>      </table>        <p>&nbsp;</p>        <table align="center" bgcolor="#ffffff" border="0" cellpadding="2" cellspacing="0" height="123" width="668">          <tbody>            <tr background="images/grey-bk.gif" bgcolor="#f7f7f7" valign="CENTER">               <td class="tutorialSubsectionHeading" height="30" width="364"><a name="creatingcorelibraryobjects" id="creatingcorelibraryobjects"></a>Creating                 Your Own CoreLibrary Objects</td>              <td align="right" width="81">&nbsp;</td>              <td align="right" width="120"><b><font face="Verdana, Arial, Helvetica, sans-serif"><font color="#b9b9b9"><a href="index.html" class="navLink"><b><font face="Verdana, Arial, Helvetica, sans-serif">Back                 to Index</font></b></a></font></font></b></td>              <td align="right" width="87">&nbsp;</td>            </tr>            <tr bgcolor="#f7f7f7">               <td colspan="4" valign="top">                 <p>All <span class="navLink"><a href="psycloneManual.html#psy:corelibrary">CoreLibrary</a></span>                   objects share a vast set of basic functionalities, and if you                   wish to create your own objects it would be to your advantage                   to create them as part of the <span class=SpellE>CoreLibrary</span>                   using the Third Party Extension mechanism. The most important                   benefit from this is that all <span class=SpellE>CoreLibrary</span>                   objects are automatically converted from and to XML when sent                   across the network. An example could be:                 <p class=MsoNormal><o:p><span class="mediumSizeNonConspicuous"><font size="1"><b>RELATED:</b></font></span><font size="1"><b><font face="Verdana, Arial, Helvetica, sans-serif"><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><font color="#333333">                   <span class="navLink"><a href="http://corelibrary.sourceforge.net/docexamples.html#_Third_Party">                   tutorial on SourceForge</a> </span><font size="1"><b><font face="Verdana, Arial, Helvetica, sans-serif"><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><span class="navLink"><a href="http://corelibrary.sourceforge.net/">CoreLibrary                   on SourceForge</a></span></font></font></b></font></font></font></font></b></font></o:p></p></td>            </tr>          </tbody>        </table>              </td>    </tr>  </tbody></table><p>&nbsp;</p><p>&nbsp; </p><table width="688" border="0" align="center" cellpadding="0" cellspacing="0">  <tbody>    <tr>      <td align="left" valign="bottom"><img src="images/simple-circle-line-1.gif" align="bottom"></td>      <td>&nbsp;</td>    </tr>  </tbody></table><table width="688" height="21" border="0" align="center" cellpadding="0" cellspacing="0">  <tbody>    <tr>      <td align="right" valign="top" width="556"><font face="Verdana, Arial, Helvetica, sans-serif"><font face="Verdana, Arial, Helvetica, sans-serif"><font size="-2"><a href="COPYRIGHT.txt">2006&copy;</a><a href="http://www.cmlabs.com">Communicative         Machines Inc.</a></font></font></font></td>      <td align="right" valign="top" width="132"><font face="Verdana, Arial, Helvetica, sans-serif"><font size="-2"><a href="LICENSE.txt">License</a></font></font></td>    </tr>  </tbody></table><map name="Map"><area shape="circle" coords="184,206,9" href="#30mins:intmodule"><area shape="circle" coords="206,214,9" href="#30mins:intmodule"><area shape="circle" coords="228,202,9" href="#30mins:intmodule"><area shape="rect" coords="99,293,252,431" href="#30mins:anotherpsyclone"><area shape="rect" coords="297,294,386,396" href="#30mins:satellites"><area shape="circle" coords="321,419,13" href="#30mins:extmodule"><area shape="circle" coords="367,417,13" href="#30mins:extmodule"><area shape="circle" coords="50,335,17" href="#30mins:extmodule"><area shape="rect" coords="16,187,69,248" href="#30mins:psyspec"><area shape="rect" coords="16,369,68,430" href="#30mins:psyspec"><area shape="rect" coords="119,131,159,170" href="#30mins:whiteboard"><area shape="rect" coords="179,140,220,181" href="#30mins:whiteboard"><area shape="circle" coords="47,154,15" href="#30mins:part1"><area shape="circle" coords="267,94,15" href="#30mins:part3"><area shape="circle" coords="151,204,14" href="#30mins:part2"><area shape="circle" coords="151,272,15" href="#30mins:part4"><area shape="circle" coords="345,273,15" href="#30mins:part5"><area shape="poly" coords="35,37,50,31,65,36,111,36,131,20,164,34,187,39,187,68,164,75,136,40,124,70,98,56,67,55,49,60,35,51" href="#30mins:micmodule"><area shape="poly" coords="326,118,342,104,419,70,573,71,573,208,419,211,331,141" href="#30mins:graphicsmodule"><area shape="poly" coords="157,67,140,69,126,91,124,115,131,131,137,113,140,89,153,75" href="#30mins:communication"><area shape="poly" coords="173,77,167,84,168,113,180,134,192,140,186,128,179,109,179,85" href="#30mins:communication"><area shape="poly" coords="222,149,232,146,273,152,321,142,328,142,328,151,275,166,226,156" href="#30mins:communication"><area shape="rect" coords="138,232,218,249" href="#30mins:part1"></map><map name="Map2"><area shape="rect" coords="306,72,382,89" href="http://sourceforge.net/projects/corelibrary/"><area shape="rect" coords="306,48,383,66" href="http://www.mindmakers.org/openair/"><area shape="rect" coords="220,9,383,27" href="usingpsyclone"></map></body></html>